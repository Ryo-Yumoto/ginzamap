<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>DT Map in Ginza</title>

  <!-- MapLibre GL JS -->
  <link rel="stylesheet" href="https://unpkg.com/maplibre-gl@4/dist/maplibre-gl.css" />
  <script src="https://unpkg.com/maplibre-gl@4/dist/maplibre-gl.js"></script>

  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <style>
    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DESIGN TOKENS
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    :root {
      /* Palette */
      --white:      #FFFFFF;
      --off-white:  #F5F5F7;
      --surface:    #FBFBFD;
      --divider:    rgba(0,0,0,.08);
      --text-1:     #1D1D1F;
      --text-2:     #6E6E73;
      --text-3:     #AEAEB2;
      --gold:       #B8943F;
      --gold-lt:    #D4AF66;
      --gold-bg:    #FBF7EE;

      /* Category accent colours (muted, editorial) */
      --c-bar:      #4A3728;
      --c-club:     #2C2C3E;
      --c-lounge:   #1C3A2E;
      --c-jazz:     #3B2035;
      --c-wine:     #5C1E2D;
      --c-hostess:  #1A2F4A;

      /* Geometry */
      --r-sm:  8px;
      --r-md:  14px;
      --r-lg:  20px;
      --r-xl:  28px;

      /* Motion */
      --ease:  cubic-bezier(.4,0,.2,1);
      --dur:   .22s;

      /* Shadows â€” Apple-style diffuse */
      --s-sm:  0 1px 3px rgba(0,0,0,.06), 0 1px 2px rgba(0,0,0,.04);
      --s-md:  0 4px 16px rgba(0,0,0,.08), 0 1px 4px rgba(0,0,0,.04);
      --s-lg:  0 12px 40px rgba(0,0,0,.12), 0 2px 8px rgba(0,0,0,.06);
      --s-xl:  0 24px 64px rgba(0,0,0,.14), 0 4px 16px rgba(0,0,0,.06);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESET
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body {
      height: 100%;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
      background: var(--off-white);
      color: var(--text-1);
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       LAYOUT
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #app {
      position: relative;
      height: 100dvh;
      /* NO overflow:hidden â€” ãã‚ŒãŒã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ»detailã‚’ã‚¯ãƒªãƒƒãƒ—ã™ã‚‹åŸå›  */
    }
    #map {
      position: absolute;
      inset: 0;
      z-index: 1;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANEL â€” single element, two states
       Normal  : full sidebar (340px wide, full height)
       Minimized: collapses to 44Ã—44 button in-place
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #panel {
      position: absolute;
      top: 20px;
      left: 20px;
      /* full state dimensions */
      width: 340px;
      bottom: 20px;
      display: flex;
      flex-direction: column;
      background: rgba(255,255,255,.96);
      backdrop-filter: saturate(180%) blur(24px);
      -webkit-backdrop-filter: saturate(180%) blur(24px);
      border-radius: 20px;
      border: 1px solid var(--divider);
      box-shadow: var(--s-xl);
      z-index: 1000;
      overflow: hidden;
      cursor: default;
      /* animate width, height (bottom), border-radius together */
      transition:
        width  .38s cubic-bezier(.4,0,.2,1),
        bottom .38s cubic-bezier(.4,0,.2,1),
        border-radius .38s cubic-bezier(.4,0,.2,1),
        box-shadow .38s cubic-bezier(.4,0,.2,1);
    }

    /* Minimized: shrink to 44Ã—44 pill in the top-left corner */
    #panel.minimized {
      width: 44px;
      bottom: calc(100% - 20px - 44px); /* top:20px + height:44px */
      border-radius: 14px;
      box-shadow: var(--s-md);
      cursor: pointer;
      overflow: hidden;
    }
    #panel.minimized:hover {
      background: var(--off-white);
    }

    /* Full content â€” shown in normal state, hidden when minimized */
    #panel-content {
      display: flex;
      flex-direction: column;
      flex: 1;
      overflow: hidden;
      /* fade out quickly when minimizing */
      transition: opacity .2s cubic-bezier(.4,0,.2,1);
      opacity: 1;
    }
    #panel.minimized #panel-content {
      opacity: 0;
      pointer-events: none;
    }

    /* Mini icon (â˜°) â€” hidden in normal state, shown when minimized */
    #panel-mini {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--text-1);
      opacity: 0;
      pointer-events: none;
      transition: opacity .18s cubic-bezier(.4,0,.2,1) .18s; /* delay = after shrink starts */
    }
    #panel.minimized #panel-mini {
      opacity: 1;
      pointer-events: auto;
    }

    /* â”€â”€ Sidebar top bar with minimize button â”€â”€ */
    #sidebar-topbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 14px 16px 0;
      flex-shrink: 0;
    }
    #sidebar-minimize {
      width: 30px; height: 30px;
      border-radius: 50%;
      border: none;
      background: var(--off-white);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-2);
      font-size: 16px;
      line-height: 1;
      transition: background var(--dur) var(--ease);
      flex-shrink: 0;
    }
    #sidebar-minimize:hover { background: var(--divider); }

    /* â”€â”€ Wordmark / Header â”€â”€ */
    #header {
      padding: 8px 20px 16px;
      border-bottom: 1px solid var(--divider);
      flex-shrink: 0;
    }

    /* h1: ã‚µã‚¤ãƒˆå */
    .wm-h1 {
      font-size: 22px;
      font-weight: 800;
      letter-spacing: -.05em;
      color: var(--text-1);
      line-height: 1.1;
      margin: 0;
    }

    /* eyebrow: ã‚«ãƒ†ã‚´ãƒªè¡¨ç¤º (æ—§ .wordmark-sub) */
    .wm-eyebrow {
      font-size: 9.5px;
      font-weight: 700;
      letter-spacing: .14em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 6px;
    }

    /* ãƒªãƒ¼ãƒ‰æ–‡ */
    .wm-lead {
      font-size: 11.5px;
      line-height: 1.65;
      color: var(--text-2);
      font-weight: 400;
      margin-top: 6px;
    }

    /* å¾Œæ–¹äº’æ› */
    .wordmark { display: flex; align-items: baseline; gap: 8px; margin-bottom: 0; }
    .wordmark-main { font-size: 20px; font-weight: 700; letter-spacing: -.03em; color: var(--text-1); }
    .wordmark-sub { font-size: 11px; font-weight: 500; letter-spacing: .12em; text-transform: uppercase; color: var(--gold); }
    .header-desc { font-size: 12px; line-height: 1.6; color: var(--text-2); max-width: 300px; }

    /* â”€â”€ Search â”€â”€ */
    #search-wrap {
      padding: 12px 16px;
      border-bottom: 1px solid var(--divider);
      flex-shrink: 0;
    }
    .search-field {
      display: flex;
      align-items: center;
      gap: 8px;
      background: var(--off-white);
      border-radius: 10px;
      padding: 0 12px;
      border: 1px solid transparent;
      transition: border-color var(--dur) var(--ease), background var(--dur) var(--ease);
    }
    .search-field:focus-within {
      border-color: var(--gold);
      background: var(--white);
      box-shadow: 0 0 0 3px rgba(184,148,63,.1);
    }
    .search-icon { color: var(--text-3); font-size: 14px; flex-shrink: 0; }
    #search {
      width: 100%;
      padding: 10px 0;
      border: none;
      background: transparent;
      font-size: 13px;
      font-family: inherit;
      color: var(--text-1);
      outline: none;
    }
    #search::placeholder { color: var(--text-3); }

    /* â”€â”€ Category Pills â”€â”€ */
    #filters {
      padding: 12px 16px 10px;
      display: flex;
      gap: 6px;
      overflow-x: auto;
      scrollbar-width: none;
      border-bottom: 1px solid var(--divider);
      flex-shrink: 0;
    }
    #filters::-webkit-scrollbar { display: none; }

    .pill {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 6px 13px;
      border-radius: 999px;
      font-size: 12px;
      font-weight: 500;
      white-space: nowrap;
      cursor: pointer;
      border: 1px solid var(--divider);
      background: var(--white);
      color: var(--text-2);
      transition: all var(--dur) var(--ease);
      user-select: none;
      letter-spacing: -.01em;
    }
    .pill:hover { border-color: var(--gold-lt); color: var(--text-1); }
    .pill.active {
      background: var(--text-1);
      border-color: var(--text-1);
      color: var(--white);
    }
    .pill-dot {
      width: 6px; height: 6px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    /* â”€â”€ List Header â”€â”€ */
    #list-header {
      padding: 14px 20px 6px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }
    #ui-all-venues {
      font-size: 13px;
      font-weight: 700;
      letter-spacing: -.02em;
      color: var(--text-1);
    }
    #count-num {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: .04em;
      color: var(--text-3);
    }

    /* â”€â”€ Spot List â”€â”€ */
    #spot-list {
      flex: 1;
      overflow-y: auto;
      padding: 4px 12px 32px;
      scrollbar-width: thin;
      scrollbar-color: var(--divider) transparent;
    }
    #spot-list::-webkit-scrollbar { width: 3px; }
    #spot-list::-webkit-scrollbar-thumb { background: var(--divider); border-radius: 3px; }

    /* â”€â”€ Spot Card â”€â”€ */
    .spot-card {
      display: flex;
      align-items: flex-start;
      gap: 13px;
      padding: 14px 10px;
      border-radius: var(--r-md);
      cursor: pointer;
      transition: background var(--dur) var(--ease);
      position: relative;
    }
    .spot-card + .spot-card { border-top: 1px solid var(--divider); margin-top: 0; border-radius: 0; }
    .spot-card:first-child { border-radius: var(--r-md) var(--r-md) 0 0; }
    .spot-card:last-child  { border-radius: 0 0 var(--r-md) var(--r-md); }
    .spot-card:only-child  { border-radius: var(--r-md); }
    .spot-card:hover  { background: var(--off-white); }
    .spot-card.active { background: var(--gold-bg); }

    .card-icon {
      width: 48px; height: 48px;
      border-radius: 11px;
      flex-shrink: 0;
      overflow: hidden;
      background: var(--off-white);
      position: relative;
    }
    .card-icon img {
      width: 100%; height: 100%;
      object-fit: cover;
      display: block;
      transition: opacity .3s;
    }
    .card-icon .icon-fallback {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
    }
    .card-body { flex: 1; min-width: 0; }
    .card-name {
      font-size: 13.5px;
      font-weight: 600;
      letter-spacing: -.02em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      color: var(--text-1);
    }
    .card-sub {
      font-size: 11.5px;
      color: var(--text-2);
      margin-top: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .card-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 6px;
      flex-wrap: wrap;
    }
    .card-price {
      font-size: 11px;
      font-weight: 500;
      color: var(--text-2);
    }
    .insider-tag {
      font-size: 9.5px;
      font-weight: 700;
      letter-spacing: .07em;
      text-transform: uppercase;
      color: var(--gold);
      background: var(--gold-bg);
      border: 1px solid rgba(184,148,63,.25);
      padding: 2px 7px;
      border-radius: 999px;
    }
    .card-chevron {
      color: var(--text-3);
      font-size: 14px;
      align-self: center;
      flex-shrink: 0;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAP
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    /* #map rules merged into layout above */

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAPLIBRE GL JS â€” ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¿ã‚¤ãƒ«
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .maplibregl-canvas { display: block; }

    /* Attribution */
    .maplibregl-ctrl-attrib {
      font-size: 9px !important;
      background: rgba(0,0,0,.45) !important;
      color: rgba(255,255,255,.55) !important;
      backdrop-filter: blur(8px) !important;
    }
    .maplibregl-ctrl-attrib a { color: rgba(255,255,255,.55) !important; }

    /* Zoom control group */
    .maplibregl-ctrl-group {
      background: rgba(20,16,32,.85) !important;
      border: 1px solid rgba(255,255,255,.18) !important;
      border-radius: 10px !important;
      box-shadow: var(--s-md) !important;
      overflow: hidden;
    }
    .maplibregl-ctrl-group button {
      font-family: inherit !important;
      color: rgba(255,255,255,.88) !important;
      background: transparent !important;
      width: 30px; height: 30px;
    }
    .maplibregl-ctrl-group button:hover {
      background: rgba(40,32,56,.88) !important;
    }
    .maplibregl-ctrl-group button + button {
      border-top: 1px solid rgba(255,255,255,.1) !important;
    }
    .maplibregl-ctrl-icon { filter: invert(1) opacity(.8); }

    /* â”€â”€ ã‚ºãƒ¼ãƒ ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«: bottomleft / PCã¯ãƒ‘ãƒãƒ«å³ç«¯ã‹ã‚‰ â”€â”€ */
    .maplibregl-ctrl-bottom-left {
      left: 380px;
      bottom: 20px;
    }
    @media (max-width: 720px) {
      .maplibregl-ctrl-bottom-left {
        left: 10px;
        bottom: 100px;
      }
    }

    /* â”€â”€ ç¾åœ¨åœ°ãƒãƒ¼ã‚«ãƒ¼ â”€â”€ */
    .user-location-marker {
      width: 18px; height: 18px;
      border-radius: 50%;
      background: #007AFF;
      border: 3px solid #fff;
      box-shadow: 0 2px 8px rgba(0,122,255,.55);
    }

    /* â”€â”€ Marker drop-in animation â”€â”€ */
    @keyframes markerDrop {
      from { opacity: 0; transform: translateY(-16px) scale(.85); }
      to   { opacity: 1; transform: translateY(0)     scale(1);   }
    }

    /* Custom marker â€” photo pin */
    .mk-pin {
      width: 46px;
      height: 54px;
      position: relative;
      filter: drop-shadow(0 3px 8px rgba(0,0,0,.28));
      animation: markerDrop .4s cubic-bezier(.34,1.56,.64,1) backwards;
    }
    .mk-circle {
      width: 46px; height: 46px;
      border-radius: 50%;
      overflow: hidden;
      border: 2.5px solid #fff;
      box-shadow: 0 2px 8px rgba(0,0,0,.18);
      background: var(--off-white);
      position: relative;
    }
    .mk-circle img {
      width: 100%; height: 100%;
      object-fit: cover;
      display: block;
    }
    .mk-circle .mk-fallback {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
    }
    /* triangle tail */
    .mk-tail {
      width: 0; height: 0;
      border-left: 7px solid transparent;
      border-right: 7px solid transparent;
      border-top: 10px solid #fff;
      margin: -1px auto 0;
      display: block;
      filter: drop-shadow(0 2px 3px rgba(0,0,0,.15));
    }
    /* active state ring */
    .mk-pin.active .mk-circle {
      border-color: var(--gold);
      border-width: 3px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       DETAIL SHEET â€” floating bottom sheet
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #detail {
      position: fixed;
      left: 380px;   /* sidebar 20px + 340px + 20px gap */
      bottom: 20px;
      width: 380px;
      max-height: calc(100dvh - 40px);
      background: var(--white);
      border-radius: var(--r-xl);
      box-shadow: var(--s-xl);
      border: 1px solid var(--divider);
      z-index: 100;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transform: translateY(calc(100% + 28px));
      transition: transform .38s var(--ease), left .3s var(--ease);
    }
    #detail.open { transform: translateY(0); }

    /* Drag handle â€” overlaid on hero image */
    .sheet-handle {
      position: absolute;
      top: 10px; left: 50%;
      transform: translateX(-50%);
      width: 36px; height: 4px;
      background: rgba(255,255,255,.7);
      border-radius: 999px;
      z-index: 6;
      pointer-events: none;
    }

    /* Close â€” overlaid on hero image */
    #detail-close {
      position: absolute;
      top: 10px; right: 12px;
      width: 30px; height: 30px;
      border-radius: 50%;
      border: none;
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(8px);
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: #fff;
      font-size: 13px;
      transition: background var(--dur) var(--ease);
      z-index: 6;
    }
    #detail-close:hover { background: rgba(0,0,0,.55); }

    /* Sheet content scroll */
    .sheet-scroll {
      overflow-y: auto;
      flex: 1;
      padding-bottom: 40px;
      scrollbar-width: none;
    }
    .sheet-scroll::-webkit-scrollbar { display: none; }

    /* Hero area */
    .sheet-hero {
      text-align: center;
    }
    /* Hero photo â€” full bleed */
    .sheet-hero-img {
      width: 100%;
      height: 220px;
      object-fit: cover;
      display: block;
      background: var(--off-white);
    }
    .sheet-hero-fallback {
      width: 100%;
      height: 180px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 64px;
    }
    .sheet-hero-text {
      padding: 16px 20px 0;
    }
    .sheet-name {
      font-size: 24px;
      font-weight: 800;
      letter-spacing: -.05em;
      color: var(--text-1);
      line-height: 1.15;
    }
    .sheet-name-jp {
      font-size: 13px;
      color: var(--text-2);
      margin-top: 5px;
      font-weight: 400;
      letter-spacing: .02em;
    }
    .sheet-cat-pill {
      display: inline-block;
      margin-top: 10px;
      font-size: 11px;
      font-weight: 600;
      letter-spacing: .06em;
      text-transform: uppercase;
      padding: 4px 12px;
      border-radius: 999px;
      color: var(--white);
    }

    /* Divider */
    .sheet-divider {
      height: 1px;
      background: var(--divider);
      margin: 18px 20px;
    }

    /* Insider tip */
    .sheet-insider {
      margin: 0 20px;
      background: var(--gold-bg);
      border-radius: var(--r-md);
      padding: 14px 16px;
      position: relative;
      border-left: 3px solid var(--gold);
    }
    .sheet-insider-label {
      font-size: 9.5px;
      font-weight: 700;
      letter-spacing: .12em;
      text-transform: uppercase;
      color: var(--gold);
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .sheet-insider-text {
      font-size: 13px;
      line-height: 1.75;
      color: #5A4315;
      font-weight: 400;
    }

    /* Description â€” h2 small */
    .sheet-desc-heading {
      font-size: 10px;
      font-weight: 700;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: var(--text-3);
      margin: 18px 20px 6px;
    }

    /* Meta grid */
    .sheet-meta {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin: 14px 20px 0;
    }
    .meta-card {
      background: var(--off-white);
      border-radius: var(--r-sm);
      padding: 10px 12px;
    }
    .meta-card-label {
      font-size: 9px;
      font-weight: 600;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: var(--text-3);
      margin-bottom: 4px;
    }
    .meta-card-val {
      font-size: 12px;
      font-weight: 500;
      color: var(--text-1);
      line-height: 1.45;
    }

    /* Description */
    .sheet-desc {
      margin: 14px 20px 0;
      font-size: 13px;
      line-height: 1.75;
      color: var(--text-2);
      font-weight: 400;
    }

    /* Tags */
    .sheet-tags {
      margin: 14px 20px 0;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .sheet-tag {
      font-size: 11px;
      font-weight: 500;
      padding: 4px 10px;
      border-radius: 999px;
      background: var(--off-white);
      color: var(--text-2);
      border: 1px solid var(--divider);
    }

    /* CTA */
    .sheet-cta {
      margin: 20px 20px 0;
      display: block;
      text-align: center;
      background: var(--text-1);
      color: var(--white);
      font-size: 14px;
      font-weight: 600;
      padding: 14px 20px;
      border-radius: var(--r-md);
      text-decoration: none;
      letter-spacing: -.01em;
      transition: background var(--dur) var(--ease), transform var(--dur) var(--ease);
    }
    .sheet-cta:hover { background: #333; transform: scale(.99); }
    .sheet-cta-sub {
      display: block;
      font-size: 11px;
      font-weight: 400;
      color: rgba(255,255,255,.6);
      margin-top: 2px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MOBILE FAB
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #fab {
      display: none;
      position: fixed;
      top: env(safe-area-inset-top, 16px);
      left: 16px;
      z-index: 200;
      width: 42px; height: 42px;
      border-radius: 12px;
      background: rgba(255,255,255,.9);
      backdrop-filter: blur(20px);
      border: 1px solid var(--divider);
      box-shadow: var(--s-md);
      cursor: pointer;
      font-size: 18px;
      align-items: center; justify-content: center;
      color: var(--text-1);
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       NIGHT MODE LABEL
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #night-label {
      position: absolute;
      top: 16px; right: 16px;
      background: rgba(255,255,255,.88);
      backdrop-filter: blur(16px);
      border: 1px solid var(--divider);
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 12px;
      font-weight: 600;
      color: var(--text-1);
      box-shadow: var(--s-sm);
      display: flex;
      align-items: center;
      gap: 6px;
      z-index: 5;
      pointer-events: none;
    }
    .night-dot {
      width: 7px; height: 7px;
      border-radius: 50%;
      background: #2D8F4A;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: .6; transform: scale(.85); }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MOBILE RESPONSIVE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    @media (max-width: 720px) {

      /* â”€â”€ ãƒ‰ãƒ©ãƒƒã‚°ãƒãƒ³ãƒ‰ãƒ« â”€â”€ */
      #panel-drag-handle {
        width: 36px; height: 4px;
        background: var(--divider);
        border-radius: 999px;
        margin: 10px auto 4px;
        flex-shrink: 0;
        cursor: grab;
      }

      /* â”€â”€ ãƒ‘ãƒãƒ«æœ¬ä½“: ãƒœãƒˆãƒ ã‚·ãƒ¼ãƒˆã¸å¤‰æ› â”€â”€ */
      #panel {
        position: fixed;
        left: 0; right: 0; bottom: 0;
        top: auto; width: 100%;
        height: 88px;
        border-radius: 20px 20px 0 0;
        padding-bottom: env(safe-area-inset-bottom, 0px);
        /* PC ã® transition ã‚’ä¸Šæ›¸ã (height/border-radius ã®ã¿) */
        transition:
          height .4s cubic-bezier(.4,0,.2,1),
          border-radius .4s cubic-bezier(.4,0,.2,1),
          box-shadow .4s cubic-bezier(.4,0,.2,1);
      }
      #panel.sheet-half {
        height: 52dvh;
        border-radius: 20px 20px 0 0;
        box-shadow: 0 -8px 40px rgba(0,0,0,.12);
      }
      #panel.sheet-full {
        height: 92dvh;
        border-radius: 14px 14px 0 0;
        box-shadow: 0 -12px 48px rgba(0,0,0,.16);
      }

      /* minimized ã‚¯ãƒ©ã‚¹ã¯ãƒ¢ãƒã‚¤ãƒ«ã§ã¯ãƒãƒ¼çŠ¶æ…‹ã¨ã—ã¦æ‰±ã† */
      #panel.minimized {
        width: 100%; height: 88px;
        top: auto; bottom: 0; left: 0; right: 0;
        border-radius: 20px 20px 0 0;
        cursor: default; box-shadow: none;
      }
      #panel.minimized #panel-content { opacity: 1; pointer-events: auto; }
      #panel.minimized #panel-mini    { opacity: 0; pointer-events: none; }

      /* PCå°‚ç”¨è¦ç´ ã‚’éè¡¨ç¤º */
      #panel-mini      { display: none; }
      #sidebar-minimize { display: none; }

      /* ãƒãƒ¼çŠ¶æ…‹ï¼ˆsheet-half/full ã§ãªã„ï¼‰ã§ã¯ä¸€éƒ¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éš ã™ */
      #panel:not(.sheet-half):not(.sheet-full) #header      { display: none; }
      #panel:not(.sheet-half):not(.sheet-full) #search-wrap { display: none; }
      #panel:not(.sheet-half):not(.sheet-full) #list-header { display: none; }
      #panel:not(.sheet-half):not(.sheet-full) #spot-list   { display: none; }
      #panel:not(.sheet-half):not(.sheet-full) #sidebar-topbar {
        padding: 4px 16px 2px;
      }

      /* topbar ã‚¿ãƒƒãƒ—é ˜åŸŸã‚’ç¢ºä¿ */
      #sidebar-topbar { cursor: pointer; min-height: 44px; }

      /* ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼: ã‚¿ãƒƒãƒã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«æœ€é©åŒ– */
      #filters {
        padding: 4px 12px 8px;
        -webkit-overflow-scrolling: touch;
      }
      .pill { padding: 7px 14px; font-size: 13px; min-height: 36px; }

      /* ãƒãƒƒãƒ—å…¨ç”»é¢ */
      #map { width: 100%; }

      /* night-label: å³ä¸Šå›ºå®š */
      #night-label {
        top: 12px; right: 12px;
        font-size: 11px; padding: 5px 10px;
      }

      /* FAB éè¡¨ç¤º */
      #fab { display: none; }

      /* Detail ã‚·ãƒ¼ãƒˆ: ãƒãƒ¼ã®ä¸Šã‹ã‚‰ slide-up */
      #detail {
        left: 0; right: 0; width: 100%; bottom: 0;
        border-radius: 20px 20px 0 0;
        max-height: 82dvh;
        transform: translateY(calc(100% + 20px));
        transition: transform .38s cubic-bezier(.4,0,.2,1);
      }
      #detail.open {
        transform: translateY(0);
        bottom: 88px;
      }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       EMPTY STATE
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .empty-state {
      text-align: center;
      padding: 48px 20px;
      color: var(--text-3);
    }
    .empty-state p { font-size: 13px; margin-top: 8px; }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SECTION GROUP HEADER  (h2 ãƒ¬ãƒ™ãƒ«)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .group-label {
      padding: 18px 10px 8px;
      font-size: 10.5px;
      font-weight: 700;
      letter-spacing: .1em;
      text-transform: uppercase;
      color: var(--gold);
      border-bottom: 1px solid var(--gold-bg);
      margin-bottom: 2px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAP CONTROL BUTTONS (lang / loc)
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .map-btn {
      position: absolute;
      right: 10px;
      width: 36px; height: 36px;
      border-radius: 10px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(20,16,32,.72);
      backdrop-filter: blur(16px);
      -webkit-backdrop-filter: blur(16px);
      box-shadow: var(--s-md);
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      font-size: 16px;
      color: rgba(255,255,255,.88);
      z-index: 500;
      transition: background var(--dur) var(--ease);
    }
    .map-btn:hover { background: rgba(40,32,56,.88); }
    #lang-btn { bottom: 130px; font-size: 11px; font-weight: 700; letter-spacing: .02em; }
    #loc-btn  { bottom: 82px; }

    /* â”€â”€ Open Now badge (card) â”€â”€ */
    .open-badge {
      color: #2D8F4A;
      font-size: 10px;
      font-weight: 600;
      margin-left: 4px;
    }

    /* â”€â”€ Share button (detail sheet) â”€â”€ */
    #share-btn {
      position: absolute; top: 10px; left: 12px; z-index: 6;
      width: 30px; height: 30px;
      border-radius: 50%; border: none;
      background: rgba(0,0,0,.35);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      cursor: pointer;
      display: flex; align-items: center; justify-content: center;
      color: #fff; font-size: 14px;
      transition: background var(--dur) var(--ease);
    }
    #share-btn:hover { background: rgba(0,0,0,.55); }

    /* â”€â”€ Toast notification â”€â”€ */
    #toast {
      position: fixed; bottom: 100px; left: 50%;
      transform: translateX(-50%) translateY(20px);
      opacity: 0; pointer-events: none;
      background: rgba(0,0,0,.8); color: #fff;
      padding: 10px 20px; border-radius: 999px;
      font-size: 13px; font-weight: 500;
      white-space: nowrap;
      transition: opacity .3s var(--ease), transform .3s var(--ease);
      z-index: 9999;
    }
    #toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* â”€â”€ Mobile: offset map buttons above bottom bar (right side, clear of zoom) â”€â”€ */
    @media (max-width: 720px) {
      #lang-btn { bottom: calc(88px + 98px); }
      #loc-btn  { bottom: calc(88px + 50px); }
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       ROUTE BUTTON + INFO BAR
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .sheet-route-btn {
      display: flex; align-items: center; gap: 8px;
      width: calc(100% - 32px); margin: 16px 16px 10px;
      padding: 13px 18px;
      background: rgba(85,53,168,.07);
      border: 1px solid rgba(85,53,168,.2);
      border-radius: var(--r-md);
      color: #5535a8;
      font-size: 14px; font-weight: 600; font-family: inherit;
      cursor: pointer;
      transition: background var(--dur) var(--ease);
      text-align: left;
    }
    .sheet-route-btn:hover { background: rgba(85,53,168,.13); }

    .route-info {
      align-items: center; gap: 8px; flex-wrap: wrap;
      padding: 4px 16px 12px;
      font-size: 13px; font-weight: 500;
      color: var(--text-2);
    }
    .route-sep { opacity: .4; }
    .route-clear-btn {
      margin-left: auto;
      background: none; border: none; cursor: pointer;
      color: var(--text-3); font-size: 12px; font-family: inherit;
      padding: 2px 4px;
      transition: color var(--dur) var(--ease);
    }
    .route-clear-btn:hover { color: var(--text-1); }

  </style>
</head>
<body>

<div id="app">

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       PANEL â€” single element, two states
       Normal: full sidebar  |  Minimized: 44Ã—44 button
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="panel" onclick="handlePanelClick(event)">

    <!-- Mini icon shown when collapsed (PC only) -->
    <div id="panel-mini" aria-label="Open panel" title="Open menu">â˜°</div>

    <!-- Drag handle (mobile only) -->
    <div id="panel-drag-handle" aria-hidden="true"></div>

    <!-- Full content shown when expanded -->
    <div id="panel-content">

      <!-- Top bar: wordmark + minimize -->
      <div id="sidebar-topbar">
        <h1 class="wm-h1">DT Map in Ginza</h1>
        <button id="sidebar-minimize" onclick="minimizeSidebar(event)" aria-label="Minimize panel" title="Minimize">
          â†
        </button>
      </div>

      <!-- Header -->
      <div id="header">
        <p class="wm-eyebrow" id="ui-tagline">Insider Guide</p>
        <p class="wm-lead" id="ui-desc">Curated by a local who has walked these streets for over 20 years. The bars, clubs, and lounges that Ginza's regulars actually go to.</p>
      </div>

      <!-- Search -->
      <div id="search-wrap">
        <div class="search-field">
          <span class="search-icon">âŒ•</span>
          <input id="search" type="text" placeholder="Search venues, vibesâ€¦" oninput="onSearch()" autocomplete="off" />
        </div>
      </div>

      <!-- Category Filter -->
      <div id="filters">
        <div class="pill active" data-cat="all" onclick="setCat('all',this)">All</div>
        <div class="pill" data-cat="bar" onclick="setCat('bar',this)">
          <span class="pill-dot" style="background:var(--c-bar)"></span> Authentic Bar
        </div>
        <div class="pill" data-cat="club" onclick="setCat('club',this)">
          <span class="pill-dot" style="background:var(--c-club)"></span> Club
        </div>
        <div class="pill" data-cat="hostess" onclick="setCat('hostess',this)">
          <span class="pill-dot" style="background:var(--c-hostess)"></span> Hostess Club
        </div>
        <div class="pill" data-cat="lounge" onclick="setCat('lounge',this)">
          <span class="pill-dot" style="background:var(--c-lounge)"></span> Lounge
        </div>
        <div class="pill" data-cat="jazz" onclick="setCat('jazz',this)">
          <span class="pill-dot" style="background:var(--c-jazz)"></span> Jazz Bar
        </div>
        <div class="pill" data-cat="wine" onclick="setCat('wine',this)">
          <span class="pill-dot" style="background:var(--c-wine)"></span> Wine Bar
        </div>
        <div class="pill" data-cat="open" onclick="setCat('open',this)">
          <span class="pill-dot" style="background:#2D8F4A"></span> Open Now
        </div>
      </div>

      <!-- List Header -->
      <div id="list-header">
        <span id="ui-all-venues">All venues</span>
        <span id="count-num">0 spots</span>
      </div>

      <!-- Spot List -->
      <div id="spot-list"></div>

    </div><!-- /panel-content -->
  </div><!-- /panel -->

  <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       MAP
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
  <div id="map">
    <div id="night-label">
      <span class="night-dot"></span> <span id="ui-nightlabel">Ginza Nightlife Map</span>
    </div>
    <button class="map-btn" id="lang-btn" onclick="toggleLang()" aria-label="Toggle language">EN</button>
    <button class="map-btn" id="loc-btn"  onclick="locateMe()"   aria-label="My location">ğŸ“</button>
  </div>

</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     DETAIL SHEET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="detail">
  <div class="sheet-handle"></div>
  <button id="share-btn" onclick="shareVenue()" aria-label="Share">â‡§</button>
  <button id="detail-close" onclick="closeDetail()" aria-label="Close">âœ•</button>
  <div class="sheet-scroll">
    <div class="sheet-hero">
      <div id="d-hero-img-wrap"></div>
      <div class="sheet-hero-text">
        <div class="sheet-name" id="d-name"></div>
        <div class="sheet-name-jp" id="d-namejp"></div>
        <span class="sheet-cat-pill" id="d-catpill"></span>
      </div>
    </div>

    <div class="sheet-divider"></div>

    <div class="sheet-insider" id="d-insider-wrap">
      <div class="sheet-insider-label">
        <span>âœ¦</span> <span id="ui-insider-tip">Insider Tip</span>
      </div>
      <div class="sheet-insider-text" id="d-insider"></div>
    </div>

    <div class="sheet-meta" id="d-meta"></div>

    <div class="sheet-divider"></div>

    <div class="sheet-desc" id="d-desc"></div>

    <div class="sheet-tags" id="d-tags"></div>

    <button class="sheet-route-btn" id="route-btn" onclick="showRoute()">
      <span>ğŸš¶</span>
      <span id="ui-route-label">ç¾åœ¨åœ°ã‹ã‚‰ã®ãƒ«ãƒ¼ãƒˆã‚’è¡¨ç¤º</span>
    </button>
    <div class="route-info" id="route-info" style="display:none">
      <span id="route-dist"></span>
      <span class="route-sep">Â·</span>
      <span id="route-time"></span>
      <button class="route-clear-btn" onclick="clearRoute()" id="ui-route-clear">âœ• ãƒ«ãƒ¼ãƒˆã‚’æ¶ˆã™</button>
    </div>

    <a class="sheet-cta" id="d-gmaps" target="_blank" rel="noopener">
      <span id="ui-gmaps-label">Open in Google Maps</span>
      <span class="sheet-cta-sub" id="ui-gmaps-sub">Tap for directions</span>
    </a>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     SPOT DATA
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
const CAT = {
  bar:     { label: 'Authentic Bar',  color: '#4A3728', bg: '#F5F0EB' },
  club:    { label: 'Club',           color: '#2C2C3E', bg: '#EEEEF5' },
  hostess: { label: 'Hostess Club',   color: '#1A2F4A', bg: '#EBF0F5' },
  lounge:  { label: 'Lounge',         color: '#1C3A2E', bg: '#EBF5F1' },
  jazz:    { label: 'Jazz Bar',       color: '#3B2035', bg: '#F2EBF5' },
  wine:    { label: 'Wine Bar',       color: '#5C1E2D', bg: '#F5EBEE' },
};

const SPOTS = [

  /* â”€â”€â”€ AUTHENTIC BAR â”€â”€â”€ */
  {
    id: 1,
    name: "Star Bar Ginza",
    nameJp: "ã‚¹ã‚¿ãƒ¼ãƒ»ãƒãƒ¼ãƒ»ã‚®ãƒ³ã‚¶",
    cat: "bar",
    emoji: "ğŸ¥ƒ",
    img: "https://tblg.k-img.com/restaurant/images/Rvw/343554/640x640_rect_9099476b87b7daa46010f9e2cc29ba2b.jpg",
    lat: 35.6743, lng: 139.7689,
    address: "B1F, 1-5-13 Ginza, Sankosha Bldg",
    hours: "17:00 â€“ 00:00 (LO 23:30)  Â·  Closed Sun",
    price: "Â¥Â¥Â¥  Cocktails from Â¥1,500 + Â¥1,100 cover",
    english: "Owner Kishi speaks English fluently",
    dresscode: "Smart casual or above",
    insider: "The owner Hisashi Kishi won the World Cocktail Championship in 1996 â€” the first Japanese ever. Ask him to make a drink with the 'Ninja Ice': a perfectly transparent block carved over three days in three freezers at different temperatures. Foreign bar professionals stop here specifically when visiting Tokyo.",
    desc: "Ginza's most internationally celebrated craft cocktail bar. Descend into a black-walled sanctuary of precision and silence. Every detail â€” glass, ice, spirit, temperature â€” is considered. A mandatory stop for anyone who takes cocktails seriously.",
    descJp: "éŠ€åº§ã‚’ä»£è¡¨ã™ã‚‹ã‚¯ãƒ©ãƒ•ãƒˆã‚«ã‚¯ãƒ†ãƒ«ãƒãƒ¼ã€‚é»’å£ã«å›²ã¾ã‚ŒãŸé™è¬ãªç©ºé–“ã§ã€ã‚°ãƒ©ã‚¹ãƒ»æ°·ãƒ»ã‚¹ãƒ”ãƒªãƒƒãƒ„ãƒ»æ¸©åº¦ã®ã™ã¹ã¦ã«å®Œç’§ãªã“ã ã‚ã‚Šã‚’æŒã¤ã€‚ã‚«ã‚¯ãƒ†ãƒ«ã‚’çœŸå‰£ã«æ„›ã™ã‚‹äººã®å¿…è¨ªåº—ã€‚",
    insiderJp: "ã‚ªãƒ¼ãƒŠãƒ¼å²¸ç¾©ä»æ°ã¯1996å¹´ä¸–ç•Œã‚«ã‚¯ãƒ†ãƒ«é¸æ‰‹æ¨©ã®æ—¥æœ¬äººåˆå„ªå‹è€…ã€‚ã€Œå¿è€…ã‚¢ã‚¤ã‚¹ã€â€”3ç¨®é¡ã®å†·å‡åº«ã§3æ—¥ã‹ã‘ã¦å‰Šã‚Šå‡ºã—ãŸå®Œå…¨é€æ˜ãªæ°·â€”ã‚’ä½¿ã£ãŸã‚«ã‚¯ãƒ†ãƒ«ã‚’é ¼ã‚“ã§ã¿ã¦ã€‚æµ·å¤–ã®ãƒãƒ¼ãƒ—ãƒ­ãŒæ±äº¬æ¥è¨ªæ™‚ã«å¿…ãšç«‹ã¡å¯„ã‚‹å ´æ‰€ã§ã‚‚ã‚ã‚‹ã€‚",
    tags: ["World Championship 1996", "Ninja Ice", "Counter seating", "No loud music"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Star+Bar+Ginza+Tokyo"
  },
  {
    id: 2,
    name: "Ne Plus Ultra",
    nameJp: "ãƒãƒ—ãƒ©ã‚¹ã‚¦ãƒ«ãƒˆãƒ©éŠ€åº§",
    cat: "bar",
    emoji: "ğŸ•¯ï¸",
    img: "https://goetheweb.jp/uploads/2023/09/ne-plus-ultra-01-1200x815.jpg",
    lat: 35.6694, lng: 139.7641,
    address: "B1F, 7-2-11 Ginza, Yokosuka 5th Bldg",
    hours: "17:00 â€“ 02:00  Â·  Closed Sun",
    price: "Â¥Â¥Â¥Â¥  Drinks from Â¥2,500",
    english: "Limited â€” call ahead",
    dresscode: "Formal / Smart",
    insider: "This is technically a members' bar, but solo visitors with genuine interest in vintage spirits are sometimes admitted. Ring the bell and say a local recommended it. The back room holds pre-war old bottles not listed on any public menu. Cuban cigars are all hand-rolled.",
    desc: "Named 'beyond the ultimate' in Spanish. An extremely private bar in Ginza 7-chome specializing in aged vintage spirits and Cuban cigars. One of the most secretive addresses in Japanese nightlife.",
    descJp: "åº—åã¯ã‚¹ãƒšã‚¤ãƒ³èªã§ã€Œç©¶æ¥µã®å½¼æ–¹ã€ã®æ„ã€‚éŠ€åº§7ä¸ç›®ã®æ¥µç§çš„ãƒãƒ¼ã€‚æˆ¦å‰ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ã‚¹ãƒ”ãƒªãƒƒãƒ„ã¨ã‚­ãƒ¥ãƒ¼ãƒç”£è‘‰å·»ã‚’çœ‹æ¿ã«ã€æ—¥æœ¬ã®å¤œã®è¡—ã§ã‚‚æœ€ã‚‚ç§˜å¯†ã‚ã„ãŸã‚¢ãƒ‰ãƒ¬ã‚¹ã€‚",
    insiderJp: "å»ºå‰ä¸Šã¯ãƒ¡ãƒ³ãƒãƒ¼åˆ¶ã ãŒã€ãƒ´ã‚£ãƒ³ãƒ†ãƒ¼ã‚¸ã‚¹ãƒ”ãƒªãƒƒãƒ„ã¸ã®çœŸã®é–¢å¿ƒã‚’æŒã¤1äººå®¢ãªã‚‰å…¥ã‚Œã‚‹ã“ã¨ã‚‚ã‚ã‚‹ã€‚ãƒ™ãƒ«ã‚’é³´ã‚‰ã—ã¦ã€Œåœ°å…ƒã®å¸¸é€£ã«å‹§ã‚ã‚‰ã‚ŒãŸã€ã¨å‘Šã’ã¦ã¿ã‚ˆã€‚å¥¥ã®éƒ¨å±‹ã«ã¯å…¬å¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¤–ã®æˆ¦å‰ãƒœãƒˆãƒ«ãŒçœ ã£ã¦ã„ã‚‹ã€‚",
    tags: ["Members preferred", "Vintage old bottles", "Cuban cigars", "Secret"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Ne+Plus+Ultra+Ginza"
  },
  {
    id: 3,
    name: "dunhill BAR",
    nameJp: "ãƒ€ãƒ³ãƒ’ãƒ« ãƒãƒ¼",
    cat: "bar",
    emoji: "ğŸª¶",
    img: "https://tblg.k-img.com/restaurant/images/Rvw/178590/640x640_rect_4886f4f1e4e86189adbc3b9801b9ba0d.jpg",
    lat: 35.6713, lng: 139.7655,
    address: "2Fâ€“3F, 3-9-8 Ginza (inside Dunhill flagship)",
    hours: "Bar: 17:00 â€“ 23:00  Â·  Lunch: 11:30 â€“ 14:00",
    price: "Â¥Â¥Â¥  Cocktails from Â¥2,000",
    english: "Bilingual staff, English menu",
    dresscode: "Smart",
    insider: "One of only two dunhill BARs on Earth â€” London and here. Most visitors only enter the ground-floor shop. Take the elevator to 2F for the counter bar, or 3F for deep leather armchairs and a curated whisky wall. Walk-ins are welcome before 19:00.",
    desc: "Hidden inside the Dunhill Ginza flagship, this bar exists nowhere else in the world except London. A refined British-Japanese sanctuary of aged Scotch, craft cocktails, and afternoon tea. The kind of place that rewards curiosity.",
    descJp: "ãƒ€ãƒ³ãƒ’ãƒ«éŠ€åº§æ——è‰¦åº—ã«éš ã•ã‚ŒãŸã€ä¸–ç•Œã§ãƒ­ãƒ³ãƒ‰ãƒ³ã¨ã“ã“ã«ã—ã‹å­˜åœ¨ã—ãªã„ãƒãƒ¼ã€‚ç†Ÿæˆã‚¹ã‚³ãƒƒãƒã¨ã‚¯ãƒ©ãƒ•ãƒˆã‚«ã‚¯ãƒ†ãƒ«ã€ã‚¢ãƒ•ã‚¿ãƒŒãƒ¼ãƒ³ãƒ†ã‚£ãƒ¼ãŒæƒã†ãƒ–ãƒªãƒ†ã‚£ãƒƒã‚·ãƒ¥Ã—æ—¥æœ¬ã®ç©ºé–“ã€‚",
    insiderJp: "1éšã®ã‚·ãƒ§ãƒƒãƒ—ã—ã‹çŸ¥ã‚‰ãªã„æ¥å®¢ãŒå¤§åŠã€‚ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ã§2Fã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ãƒãƒ¼ã€ã¾ãŸã¯3Fã®æ·±ã„é©å¼µã‚Šã‚½ãƒ•ã‚¡ã¨ã‚¦ã‚¤ã‚¹ã‚­ãƒ¼ã‚¦ã‚©ãƒ¼ãƒ«ã¸ã€‚19æ™‚å‰ãªã‚‰äºˆç´„ãªã—ã§å…¥ã‚Œã‚‹ã€‚",
    tags: ["Only in London & Ginza", "Afternoon tea", "Leather lounge", "Walk-in before 19:00"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=dunhill+BAR+Ginza+Tokyo"
  },
  {
    id: 4,
    name: "Bar Hoshi",
    nameJp: "ãƒãƒ¼ä¿å¿—",
    cat: "bar",
    emoji: "ğŸŒ™",
    img: "https://tblg.k-img.com/restaurant/images/Rvw/94282/640x640_rect_94282105.jpg",
    lat: 35.6730, lng: 139.7665,
    address: "6F, 8-8-7 Ginza",
    hours: "18:00 â€“ 02:00  Â·  Closed Sun",
    price: "Â¥Â¥Â¥  Cocktails from Â¥1,800",
    english: "Basic English â€” gesture-friendly",
    dresscode: "Smart casual",
    insider: "Barman Yuichi Hoshi has won multiple national and international cocktail competitions. Order the signature 'Falling Star' â€” a rum-based creation he's refined for decades. Sit at the counter and let him guide you. He doesn't need you to speak Japanese.",
    desc: "A timeless Ginza oasis where master barman Yuichi Hoshi presides over a beautifully restrained counter. Award-winning cocktails meet quiet contemplation. The antithesis of noisy nightlife â€” come here to drink well and think.",
    descJp: "ãƒã‚¹ã‚¿ãƒ¼ãƒãƒ¼ãƒãƒ³æ˜Ÿé›„ä¸€æ°ãŒé™è¬ãªã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã«ç«‹ã¤ã€éŠ€åº§ã®æ°¸é ã®ã‚ªã‚¢ã‚·ã‚¹ã€‚å—è³æ­´ã®ã‚ã‚‹ã‚«ã‚¯ãƒ†ãƒ«ã¨é™ã‹ãªæ€ç´¢ã®æ™‚é–“ã€‚å–§é¨’ã®å¤œã¨ã¯å¯¾æ¥µã®å ´æ‰€ã€‚",
    insiderJp: "æ˜Ÿæ°ã¯å›½å†…å¤–ã®ã‚«ã‚¯ãƒ†ãƒ«ã‚³ãƒ³ãƒšã§æ•°å¤šãã®å—è³çµŒé¨“ã‚’æŒã¤ã€‚ã‚·ã‚°ãƒãƒãƒ£ãƒ¼ã€Œãƒ•ã‚©ãƒ¼ãƒªãƒ³ã‚°ãƒ»ã‚¹ã‚¿ãƒ¼ã€â€”æ•°åå¹´ã‹ã‘ã¦ç£¨ã„ãŸãƒ©ãƒ ãƒ™ãƒ¼ã‚¹ã®ä¸€æ¯â€”ã‚’æ³¨æ–‡ã—ã‚ˆã†ã€‚æ—¥æœ¬èªãŒè©±ã›ãªãã¦ã‚‚å¤§ä¸ˆå¤«ã€‚",
    tags: ["Award-winning cocktails", "Counter only", "Quiet atmosphere", "Falling Star"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Bar+Hoshi+Ginza+Tokyo"
  },
  {
    id: 5,
    name: "Bar Shake",
    nameJp: "ãƒãƒ¼ ã‚·ã‚§ã‚¤ã‚¯",
    cat: "bar",
    emoji: "ğŸ«—",
    img: "https://tblg.k-img.com/restaurant/images/Rvw/22052/640x640_rect_22052151.jpg",
    lat: 35.6719, lng: 139.7648,
    address: "B1F, Sukiya-dori, Ginza 5-chome",
    hours: "18:00 â€“ 02:00 (Friâ€“Sat until 03:00)",
    price: "Â¥Â¥  Cocktails from Â¥1,200",
    english: "Menu in English available",
    dresscode: "Casual smart",
    insider: "Push open the heavy door and descend. The interior is stripped back to pure atmosphere â€” dark wood, warm light, no distractions. This is where Ginza locals go when they want a serious drink without ceremony. Prices are honest for the quality.",
    desc: "A Sukiya-dori basement bar that has quietly become a favourite of Ginza's in-the-know crowd. No gimmicks, no theatre â€” just exceptional cocktails in an environment designed purely for the pleasure of drinking.",
    descJp: "æ•°å¯„å±‹é€šã‚Šã®åœ°ä¸‹ãƒãƒ¼ã€‚éŠ€åº§ã®é€šå¥½ã¿ã«å¯†ã‹ãªäººæ°—ã‚’èª‡ã‚‹ã€‚ã‚®ãƒŸãƒƒã‚¯ãªã—ã€éå‰°ãªæ¼”å‡ºãªã—â€”ãŸã é£²ã‚€ã“ã¨ã®å–œã³ã ã‘ãŒç©ºé–“ã‚’æº€ãŸã™ã€‚",
    insiderJp: "é‡ã„æ‰‰ã‚’æŠ¼ã—ã¦åœ°ä¸‹ã¸é™ã‚Šã‚ã€‚ãƒ€ãƒ¼ã‚¯ã‚¦ãƒƒãƒ‰ã¨æ¸©ã‹ãªç¯ã‚Šã ã‘ã®ã‚¹ãƒˆã‚¤ãƒƒã‚¯ãªç©ºé–“ã€‚éŠ€åº§ã®ãƒ­ãƒ¼ã‚«ãƒ«ãŒå„€å¼ãªã—ã§æœ¬æ°—ã®ä¸€æ¯ã‚’é£²ã¿ãŸã„ã¨ãã«æ¥ã‚‹å ´æ‰€ã€‚æ–™é‡‘ã¯ã‚¯ã‚ªãƒªãƒ†ã‚£ã«å¯¾ã—ã¦èª å®Ÿã€‚",
    tags: ["Basement bar", "Approachable entry", "Ginza locals", "No frills"],
    insider_flag: false,
    gmaps: "https://maps.google.com/?q=Bar+Shake+Ginza+Tokyo"
  },

  /* â”€â”€â”€ HOSTESS CLUB â”€â”€â”€ */
  {
    id: 6,
    name: "Club Chic",
    nameJp: "ã‚¯ãƒ©ãƒ–ãƒãƒƒã‚¯",
    cat: "hostess",
    emoji: "ğŸ¥‚",
    img: "https://satsuei-navi.com/ginza-chick/image/L210_064_ginza-chick_01.jpg",
    lat: 35.6712, lng: 139.7658,
    address: "Ginza 8-chome area (exact floor disclosed at booking)",
    hours: "19:00 â€“ 02:00  Â·  Closed Sun",
    price: "Â¥Â¥Â¥Â¥Â¥  Budget Â¥50,000+/person (incl. bottle)",
    english: "Introduction or booking service recommended",
    dresscode: "Formal â€” suit required",
    insider: "One of Ginza's true high-end clubs, frequented by senior executives and public figures. The interior is extraordinary â€” chandelier-heavy, European grandeur. First-time foreign guests should arrange entry through a concierge or a Japanese business contact who is already a member.",
    desc: "A landmark Ginza hostess club known for impeccable presentation and an exclusive clientele. Multi-room layout with VIP suites. The chandeliers alone are worth the visit. Represents the pinnacle of traditional Ginza club culture.",
    descJp: "éã®æ‰“ã¡ã©ã“ã‚ã®ãªã„æ¥å®¢ã¨é¸ã°ã‚ŒãŸé¡§å®¢ã§çŸ¥ã‚‰ã‚Œã‚‹éŠ€åº§ã®ä¼èª¬çš„ã‚¯ãƒ©ãƒ–ã€‚VIPã‚¹ã‚¤ãƒ¼ãƒˆã‚’å«ã‚€è¤‡æ•°ãƒ•ãƒ­ã‚¢æ§‹æˆã€‚ã‚·ãƒ£ãƒ³ãƒ‡ãƒªã‚¢ã ã‘ã§è¨ªå•ã™ã‚‹ä¾¡å€¤ãŒã‚ã‚‹ã€‚",
    insiderJp: "éŠ€åº§æœ‰æ•°ã®æœ¬ç‰©ã®é«˜ç´šã‚¯ãƒ©ãƒ–ã€‚ä¸Šç´šç®¡ç†è·ã‚„è‘—åäººãŒå¸¸é€£ã€‚åˆã‚ã¦ã®å¤–å›½äººã‚²ã‚¹ãƒˆã¯ã‚³ãƒ³ã‚·ã‚§ãƒ«ã‚¸ãƒ¥ã‹æ—¥æœ¬äººãƒ“ã‚¸ãƒã‚¹ã‚³ãƒ³ã‚¿ã‚¯ãƒˆã‚’é€šã˜ã¦å…¥åº—ã‚’æ‰‹é…ã™ã‚‹ã®ãŒãƒ™ã‚¹ãƒˆã€‚",
    tags: ["VIP rooms", "Business entertainment", "Introduction preferred", "Grand interior"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Club+Chic+Ginza+Tokyo"
  },
  {
    id: 7,
    name: "Club Next Ginza",
    nameJp: "ãƒã‚¯ã‚¹ãƒˆéŠ€åº§",
    cat: "hostess",
    emoji: "âœ¨",
    img: "https://ginza-irodori.com/wp-content/uploads/2024/07/S__65110081_0-1024x768-1.webp",
    lat: 35.6701, lng: 139.7644,
    address: "Ginza 8-chome, Namiki-dori",
    hours: "19:00 â€“ 02:00  Â·  Closed Sun",
    price: "Â¥Â¥Â¥Â¥  From Â¥30,000/person",
    english: "Some English-speaking staff available on request",
    dresscode: "Smart â€” jacket recommended",
    insider: "The most famous name in modern Ginza clubs. Large-format, high energy, and slightly more accessible than traditional members-only clubs. Walk-in possible but booking via their website or phone ensures a better table. Popular for entertaining international business guests.",
    desc: "The definitive modern Ginza hostess club. Namiki-dori's flagship large-venue club that elevated what Ginza nightlife could be. A blend of traditional omotenashi hospitality with a vibrant contemporary atmosphere.",
    descJp: "ç¾ä»£éŠ€åº§ã‚’è±¡å¾´ã™ã‚‹ãƒ›ã‚¹ãƒ†ã‚¹ã‚¯ãƒ©ãƒ–ã®ä»£åè©ã€‚ä¸¦æœ¨é€šã‚Šã«æ§‹ãˆã‚‹å¤§å‹ãƒ•ãƒ©ãƒƒã‚°ã‚·ãƒƒãƒ—ã€‚ä¼çµ±çš„ãªãŠã‚‚ã¦ãªã—ã¨èºå‹•æ„Ÿã‚ã‚‹ç¾ä»£çš„é›°å›²æ°—ã‚’èåˆã•ã›ãŸã€‚",
    insiderJp: "éŠ€åº§ã‚¯ãƒ©ãƒ–ã§æœ€ã‚‚çŸ¥ååº¦ã®é«˜ã„åå‰ã€‚å¤§ç®±ã§æ´»æ°—ãŒã‚ã‚Šã€å¾“æ¥ã®ä¼šå“¡åˆ¶ã‚¯ãƒ©ãƒ–ã‚ˆã‚Šå…¥ã‚Šã‚„ã™ã„ã€‚ã‚¦ã‚©ãƒ¼ã‚¯ã‚¤ãƒ³ã‚‚å¯èƒ½ã ãŒã€ã‚¦ã‚§ãƒ–ã‚„é›»è©±ã‹ã‚‰ã®äº‹å‰äºˆç´„ãŒè‰¯ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®è¿‘é“ã€‚æµ·å¤–ãƒ“ã‚¸ãƒã‚¹ã‚²ã‚¹ãƒˆã®æ¥å¾…ã§ã‚‚å®šç•ªã€‚",
    tags: ["Namiki-dori", "Large venue", "Online booking available", "Business use"],
    insider_flag: false,
    gmaps: "https://maps.google.com/?q=Club+Next+Ginza+Tokyo"
  },
  {
    id: 8,
    name: "Club Athena",
    nameJp: "ã‚¯ãƒ©ãƒ– ã‚¢ãƒ†ãƒŠ",
    cat: "hostess",
    emoji: "ğŸ›ï¸",
    img: null,
    lat: 35.6708, lng: 139.7660,
    address: "Ginza 7â€“8 chome area",
    hours: "19:00 â€“ 02:00",
    price: "Â¥Â¥Â¥Â¥  From Â¥35,000/person",
    english: "Limited â€” introduction recommended",
    dresscode: "Formal",
    insider: "Four separate floors, each with a different atmosphere â€” a rarity even in Ginza. The VIP private rooms include karaoke and dedicated bathroom. The European-style main floor is the most photogenic room in Ginza nightlife. Worth requesting a floor tour before being seated.",
    desc: "An opulent multi-floor hostess club with distinct atmospheres per floor. The European main room is dramatic; the private suites are discreet. A go-to choice for entertaining guests who want a genuinely memorable evening.",
    descJp: "ãƒ•ãƒ­ã‚¢ã”ã¨ã«ç•°ãªã‚‹é›°å›²æ°—ã‚’æŒã¤è±ªå¥¢ãªãƒ›ã‚¹ãƒ†ã‚¹ã‚¯ãƒ©ãƒ–ã€‚ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘èª¿ã®ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ã‚¢ãŒåœ§å·»ã€‚è¨˜æ†¶ã«æ®‹ã‚‹å¤œã‚’æ¼”å‡ºã™ã‚‹ã€ç‰¹åˆ¥ãªå¤œå‘ã‘ã®é¸æŠè‚¢ã€‚",
    insiderJp: "éŠ€åº§ã§ã‚‚ç¨€å°‘ãª4ãƒ•ãƒ­ã‚¢æ§‹æˆã€‚å„ãƒ•ãƒ­ã‚¢ã«å€‹æ€§ãŒã‚ã‚Šã€ã‚«ãƒ©ã‚ªã‚±ä»˜ãå°‚ç”¨ãƒã‚¹ãƒ«ãƒ¼ãƒ ã®VIPã‚¹ã‚¤ãƒ¼ãƒˆã‚‚å‚™ãˆã‚‹ã€‚ãƒ¨ãƒ¼ãƒ­ãƒƒãƒ‘æ§˜å¼ã®ãƒ¡ã‚¤ãƒ³ãƒ•ãƒ­ã‚¢ã¯éŠ€åº§ãƒŠã‚¤ãƒˆãƒ©ã‚¤ãƒ•ã§æœ€ã‚‚çµµã«ãªã‚‹ç©ºé–“ã€‚ç€å¸­å‰ã«ãƒ•ãƒ­ã‚¢ãƒ„ã‚¢ãƒ¼ã‚’ç”³ã—å‡ºã¦ã¿ã‚‹ã¨è‰¯ã„ã€‚",
    tags: ["4 floors", "Private karaoke suites", "European interior", "Full evening experience"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Club+Athena+Ginza+Tokyo"
  },
  {
    id: 9,
    name: "Club Sakurako",
    nameJp: "ã‚¯ãƒ©ãƒ– æ¡œå­",
    cat: "hostess",
    emoji: "ğŸŒ¸",
    img: null,
    lat: 35.6705, lng: 139.7636,
    address: "Near Shimbashi Ginza exit, 4 min walk",
    hours: "19:00 â€“ 01:30",
    price: "Â¥Â¥Â¥Â¥  From Â¥25,000/person",
    english: "Some staff speak conversational English",
    dresscode: "Smart â€” jacket preferred",
    insider: "Known among insiders as the most refined atmosphere without the intimidating price floor of the very top clubs. Simple, understated interior â€” the opposite of flashy. The quality of conversation and service here consistently outperforms much more expensive venues.",
    desc: "A discreet, high-quality hostess club near Shimbashi with a calm, unhurried atmosphere. Less ostentatious than the mega-clubs â€” chosen by guests who value substance over spectacle. A favourite of Ginza veterans.",
    descJp: "æ–°æ©‹è‡³è¿‘ã®é™ã‹ã§å“ã®ã‚ã‚‹ãƒ›ã‚¹ãƒ†ã‚¹ã‚¯ãƒ©ãƒ–ã€‚éåº¦ãªè£…é£¾ã‚’å»ƒã—ã€è³ªã®é«˜ã„ä¼šè©±ã¨ã‚µãƒ¼ãƒ“ã‚¹ã‚’è»¸ã«æ®ãˆã‚‹ã€‚è¯ç¾ã‚ˆã‚Šå®Ÿè³ªã‚’é‡ã‚“ã˜ã‚‹ã‚²ã‚¹ãƒˆã¨éŠ€åº§é€šãŒæ„›ç”¨ã™ã‚‹ã€‚",
    insiderJp: "å†…è¼ªã§ã¯ã€Œæœ€é«˜å³°ã®ä¾¡æ ¼å¸¯ã«åŒ¹æ•µã™ã‚‹é›°å›²æ°—ã‚’ã€æ°—å¾Œã‚Œãªãä½“é¨“ã§ãã‚‹å ´æ‰€ã€ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã‚‹ã€‚å†…è£…ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§é£¾ã‚Šæ°—ãŒãªãã€ã‚€ã—ã‚ãã‚ŒãŒæ½”ã„ã€‚ã‚¯ã‚ªãƒªãƒ†ã‚£ã¯ãšã£ã¨é«˜é¡ãªã‚¯ãƒ©ãƒ–ã‚’å‡Œãã“ã¨ã‚‚å¤šã„ã€‚",
    tags: ["Understated elegance", "Shimbashi access", "No-frills pricing", "Veteran favourite"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Club+Sakurako+Ginza+Tokyo"
  },

  /* â”€â”€â”€ LOUNGE â”€â”€â”€ */
  {
    id: 10,
    name: "Magdalena â€” Grand Bach Tokyo Ginza",
    nameJp: "ãƒã‚°ãƒ€ãƒ¬ãƒ¼ãƒŠ",
    cat: "lounge",
    emoji: "ğŸ¹",
    img: "https://tblg.k-img.com/restaurant/images/Rvw/254659/640x640_rect_6f649af24a6f219274b1bd04f15967a2.jpg",
    lat: 35.6697, lng: 139.7700,
    address: "Hotel Grand Bach Tokyo Ginza, Higashi-Ginza",
    hours: "17:00 â€“ 01:00 (Sun until 23:00)",
    price: "Â¥Â¥Â¥  Cocktails from Â¥1,600",
    english: "English menu, bilingual staff",
    dresscode: "Smart casual",
    insider: "Named after Bach's wife Magdalena â€” the entire hotel is themed around the composer. Live classical piano plays on selected evenings. Arrive at 18:30 on a Thursday for the best chance of a performance. The 'Bach Cocktail' is a signature that changes seasonally.",
    desc: "A beautifully designed hotel bar and lounge themed around Johann Sebastian Bach. Classical music plays softly; the interiors are warm and deeply considered. One of the most sophisticated places to open or close an evening in Ginza.",
    descJp: "ãƒ¨ãƒãƒ³ãƒ»ã‚»ãƒã‚¹ãƒ†ã‚£ã‚¢ãƒ³ãƒ»ãƒãƒƒãƒã‚’ãƒ†ãƒ¼ãƒã«ã—ãŸä¸Šè³ªãªãƒ›ãƒ†ãƒ«ãƒãƒ¼ï¼†ãƒ©ã‚¦ãƒ³ã‚¸ã€‚ã‚¯ãƒ©ã‚·ãƒƒã‚¯éŸ³æ¥½ã¨ç²¾ç·»ãªã‚¤ãƒ³ãƒ†ãƒªã‚¢ãŒå¤œã®æœ€è‰¯ã®å§‹ã¾ã‚Šã¨ç· ã‚ããã‚Šã‚’æ¼”å‡ºã™ã‚‹ã€‚",
    insiderJp: "åº—åã¯ãƒãƒƒãƒã®å¦»ãƒã‚°ãƒ€ãƒ¬ãƒ¼ãƒŠã«ã¡ãªã‚€â€”â€”ãƒ›ãƒ†ãƒ«å…¨ä½“ãŒã“ã®ä½œæ›²å®¶ã‚’ãƒ†ãƒ¼ãƒã«ã—ã¦ã„ã‚‹ã€‚ç‰¹å®šã®å¤œã«ã¯ç”Ÿã®ã‚¯ãƒ©ã‚·ãƒƒã‚¯ãƒ”ã‚¢ãƒãŒæ¼”å¥ã•ã‚Œã‚‹ã€‚æœ¨æ›œ18:30ç€ãŒæ¼”å¥ã«å½“ãŸã‚‹ç¢ºç‡ãŒæœ€ã‚‚é«˜ã„ã€‚å­£ç¯€ã”ã¨ã«å¤‰ã‚ã‚‹ã‚·ã‚°ãƒãƒãƒ£ãƒ¼ã€Œãƒãƒƒãƒã‚«ã‚¯ãƒ†ãƒ«ã€ã‚’ãœã²ã€‚",
    tags: ["Classical music", "Hotel bar", "Live piano (selected evenings)", "Bach Cocktail"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Hotel+Grand+Bach+Tokyo+Ginza"
  },
  {
    id: 11,
    name: "Lounge Bar Courage",
    nameJp: "ãƒ©ã‚¦ãƒ³ã‚¸ãƒãƒ¼ ã‚¯ãƒ©ãƒ¼ã‚¸ãƒ¥",
    cat: "lounge",
    emoji: "ğŸŒƒ",
    img: "https://courage-yurakucho.com/wp-content/uploads/2021/12/20211203_top_sub.jpg",
    lat: 35.6740, lng: 139.7610,
    address: "Near Hibiya Station, 1 min walk",
    hours: "18:00 â€“ 02:00  Â·  Closed Sun",
    price: "Â¥Â¥Â¥  From Â¥2,000 cover",
    english: "English menu available",
    dresscode: "Smart casual",
    insider: "The elevator opens directly into the lounge â€” no corridor, no announcement â€” just an immediate reveal of a non-ordinary space. The lighting is perfect. Go on a weeknight and you may have the room almost to yourself. Regulars describe it as 'the adult Ginza that most tourists never find.'",
    desc: "An elegant lounge bar accessible via Hibiya â€” geographically close to Ginza but in a quieter, more residential register. The carefully lit interior rewards slow evenings. Staff are attentive without being intrusive.",
    descJp: "æ—¥æ¯”è°·é§…è‡³è¿‘ã®æ´—ç·´ã•ã‚ŒãŸãƒ©ã‚¦ãƒ³ã‚¸ãƒãƒ¼ã€‚éŠ€åº§ã«åœ°ç†çš„ã«è¿‘ã„ãŒã€ã‚ˆã‚Šé™ã‹ã§ä¸Šå“ãªç©ºæ°—ã€‚ä¸å¯§ã«è¨­è¨ˆã•ã‚ŒãŸç…§æ˜ãŒç·©ã‚„ã‹ãªå¤œã‚’å¼•ãç«‹ã¦ã‚‹ã€‚",
    insiderJp: "ã‚¨ãƒ¬ãƒ™ãƒ¼ã‚¿ãƒ¼ãŒç›´æ¥ãƒ©ã‚¦ãƒ³ã‚¸ã¸é–‹ãâ€”â€”å»Šä¸‹ã‚‚äºˆå‘Šã‚‚ãªãã€éæ—¥å¸¸ã®ç©ºé–“ãŒå³åº§ã«ç›®ã®å‰ã«åºƒãŒã‚‹ã€‚ç…§æ˜ã¯å®Œç’§ã€‚å¹³æ—¥ã®å¤œã¯ã»ã¼è²¸ã—åˆ‡ã‚ŠçŠ¶æ…‹ã«ãªã‚‹ã“ã¨ã‚‚ã€‚å¸¸é€£ã¯ã€Œè¦³å…‰å®¢ãŒæ±ºã—ã¦è¾¿ã‚Šç€ã‹ãªã„å¤§äººã®éŠ€åº§ã€ã¨èªã‚‹ã€‚",
    tags: ["Hibiya access", "Elevator reveal", "Quiet weeknights", "Non-tourist"],
    insider_flag: false,
    gmaps: "https://maps.google.com/?q=Lounge+Bar+Courage+Hibiya+Tokyo"
  },

  /* â”€â”€â”€ JAZZ BAR â”€â”€â”€ */
  {
    id: 12,
    name: "Swing",
    nameJp: "ã‚¹ã‚¦ã‚£ãƒ³ã‚°",
    cat: "jazz",
    emoji: "ğŸ·",
    img: "https://ginzaswing.jp/wp22/wp-content/uploads/slider/cache/09c9e5adc02e6d841ec8d0b8e6c20708/000051main.jpg",
    lat: 35.6726, lng: 139.7672,
    address: "Ginza 5-chome, upper floors",
    hours: "18:00 â€“ 03:00  Â·  Daily",
    price: "Â¥Â¥  Cover Â¥1,000 + drinks from Â¥800",
    english: "Music is universal â€” very welcoming to foreigners",
    dresscode: "Casual to smart",
    insider: "One of the longest-running jazz bars in Ginza â€” live sessions most evenings, recorded vinyl during off-sets. The crowd is older, knowledgeable, and deeply appreciative. Foreign jazz lovers are welcomed with particular warmth. Ask the bartender about the weekly live schedule.",
    desc: "A Ginza jazz institution where serious listeners gather around vinyl and live performance. Dark, intimate, with the haze of decades of good music embedded in the walls. The kind of place that still exists only in Tokyo.",
    descJp: "çœŸå‰£ãªãƒªã‚¹ãƒŠãƒ¼ãŒãƒ´ã‚¡ã‚¤ãƒŠãƒ«ã¨ç”Ÿæ¼”å¥ã‚’å›²ã‚€éŠ€åº§ã‚¸ãƒ£ã‚ºã®æ®¿å ‚ã€‚è–„æš—ãè¦ªå¯†ãªç©ºé–“ã«ã€å¹¾åå¹´åˆ†ã®è‰¯è³ªãªéŸ³æ¥½ãŒæŸ“ã¿è¾¼ã‚“ã§ã„ã‚‹ã€‚æ±äº¬ã«ã—ã‹å­˜åœ¨ã—ãªã„ç¨®é¡ã®å ´æ‰€ã€‚",
    insiderJp: "éŠ€åº§ã§æœ€ã‚‚é•·ã„æ­´å²ã‚’æŒã¤ã‚¸ãƒ£ã‚ºãƒãƒ¼ã®ä¸€ã¤ã€‚ç”Ÿã‚»ãƒƒã‚·ãƒ§ãƒ³ã¯ã»ã¼æ¯æ™©è¡Œã‚ã‚Œã€åˆé–“ã«ã¯ãƒ´ã‚¡ã‚¤ãƒŠãƒ«ãŒå›ã‚‹ã€‚å®¢å±¤ã¯å¹´é…ã§éŸ³æ¥½ã¸ã®é€ è©£ãŒæ·±ã„ã€‚å¤–å›½äººã‚¸ãƒ£ã‚ºãƒ•ã‚¡ãƒ³ã¯ç‰¹ã«æ¸©ã‹ãè¿ãˆã‚‰ã‚Œã‚‹ã€‚é€±æ¬¡ãƒ©ã‚¤ãƒ–ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ãƒãƒ¼ãƒ†ãƒ³ãƒ€ãƒ¼ã«èã“ã†ã€‚",
    tags: ["Live jazz (most nights)", "Vinyl sessions", "Foreign-friendly", "Late nights"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Swing+Jazz+Bar+Ginza+Tokyo"
  },
  {
    id: 13,
    name: "7th",
    nameJp: "ã‚»ãƒ–ãƒ³ã‚¹",
    cat: "jazz",
    emoji: "ğŸº",
    img: null,
    lat: 35.6718, lng: 139.7680,
    address: "Ginza 6â€“7 chome, 7th floor",
    hours: "19:00 â€“ 02:30  Â·  Closed Mon",
    price: "Â¥Â¥  Cover Â¥800 + drinks from Â¥700",
    english: "Staff speaks basic English",
    dresscode: "Casual",
    insider: "Small, high-ceilinged, with a long bar and a small stage in the corner. The name '7th' refers to the musical seventh chord â€” and everything here is built around that richness. When a live trio plays, the acoustics are remarkable for such a small space. Best visited after 21:30.",
    desc: "A compact, high-quality jazz bar on the 7th floor of a Ginza building. Named after the musical seventh chord. Live trio performances on selected evenings in an acoustically considered space. Small enough that every seat is close to the stage.",
    descJp: "éŠ€åº§ã®ãƒ“ãƒ«7éšã«æ§‹ãˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆã§è³ªã®é«˜ã„ã‚¸ãƒ£ã‚ºãƒãƒ¼ã€‚éŸ³æ¥½çš„ãªã€Œã‚»ãƒ–ãƒ³ã‚¹ï¼ˆä¸ƒåº¦ï¼‰ã‚³ãƒ¼ãƒ‰ã€ã‚’åº—åã«å† ã—ã€ãã®è±Šã‹ã•ãŒç©ºé–“å…¨ä½“ã«å®¿ã‚‹ã€‚",
    insiderJp: "é«˜ã„å¤©äº•ã«é•·ã„ãƒãƒ¼ã¨ã‚³ãƒ¼ãƒŠãƒ¼ã®å°ã‚¹ãƒ†ãƒ¼ã‚¸ã€‚ãƒ©ã‚¤ãƒ–ãƒˆãƒªã‚ªãŒæ¼”å¥ã™ã‚‹å¤œã®éŸ³éŸ¿ã¯ç©ºé–“ã®è¦æ¨¡ã‚’è¶…ãˆãŸç´ æ™´ã‚‰ã—ã•ã€‚å…¨ã¦ã®å¸­ãŒã‚¹ãƒ†ãƒ¼ã‚¸ã«è¿‘ãã€ã©çœŸã‚“ä¸­ã§è´ã‘ã‚‹ã€‚21:30ä»¥é™ã®è¨ªå•ãŒæœ€å–„ã€‚",
    tags: ["7th floor", "Live trio", "Small venue", "Late nights"],
    insider_flag: false,
    gmaps: "https://maps.google.com/?q=7th+Jazz+Bar+Ginza+Tokyo"
  },

  /* â”€â”€â”€ WINE BAR â”€â”€â”€ */
  {
    id: 14,
    name: "Ginza Wine Bar G5",
    nameJp: "éŠ€åº§ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ G5",
    cat: "wine",
    emoji: "ğŸ·",
    img: "https://tblg.k-img.com/restaurant/images/Rvw/344457/640x640_rect_5cff201a5316ada51cc57d6e47b80380.jpg",
    lat: 35.6724, lng: 139.7639,
    address: "5-chome Ginza, 3 min from Exit A1/A2",
    hours: "17:00 â€“ 00:00  Â·  Closed Sun",
    price: "Â¥Â¥Â¥  Glasses from Â¥1,500  Â·  Bottles available",
    english: "Full English wine list",
    dresscode: "Smart casual",
    insider: "The defining feature: they open bottles that would otherwise only be available by the bottle at auction prices. You can order a 10cl pour of a Grand Cru Burgundy or a first-growth Bordeaux. The sommelier â€” a Ginza veteran â€” speaks excellent English and will educate freely if you show interest.",
    desc: "A specialist wine bar offering by-the-glass access to bottles that most Tokyo restaurants reserve for table-service by the bottle. The curated list rotates constantly. A genuine destination for wine lovers who want to taste above their usual budget.",
    descJp: "é€šå¸¸ã¯ãƒœãƒˆãƒ«å˜ä½ã§ã—ã‹é£²ã‚ãªã„ãƒ¯ã‚¤ãƒ³ã‚’ã‚°ãƒ©ã‚¹ã§æ¥½ã—ã‚ã‚‹å°‚é–€ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ã€‚ã‚»ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã¯å¸¸æ™‚æ›´æ–°ã€‚äºˆç®—ã‚’è¶…ãˆãŸä¸€æ¯ã‚’æ±‚ã‚ã‚‹ãƒ¯ã‚¤ãƒ³æ„›å¥½å®¶ã®æœ¬ç‰©ã®ç›®çš„åœ°ã€‚",
    insiderJp: "æœ€å¤§ã®ç‰¹å¾´ã¯ã‚ªãƒ¼ã‚¯ã‚·ãƒ§ãƒ³ä¾¡æ ¼ç´šã®ãƒœãƒˆãƒ«ã‚’10clå˜ä½ã§æ³¨æ–‡ã§ãã‚‹ã“ã¨ã€‚ã‚°ãƒ©ãƒ³ã‚¯ãƒªãƒ¥ãƒ–ãƒ«ã‚´ãƒ¼ãƒ‹ãƒ¥ã‚„1ç´šæ ¼ä»˜ã‘ãƒœãƒ«ãƒ‰ãƒ¼ã‚‚ä¸€æ¯ã‹ã‚‰ã€‚éŠ€åº§ãƒ™ãƒ†ãƒ©ãƒ³ã®ã‚½ãƒ ãƒªã‚¨ã¯è‹±èªå ªèƒ½ã§ã€èˆˆå‘³ã‚’ç¤ºã›ã°ã„ãã‚‰ã§ã‚‚æ•™ãˆã¦ãã‚Œã‚‹ã€‚",
    tags: ["Grand Cru by the glass", "English sommelier", "Rotating selection", "Small producer focus"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Ginza+Wine+Bar+G5+Tokyo"
  },
  {
    id: 15,
    name: "Enoteca Castello",
    nameJp: "ã‚¨ãƒãƒ†ã‚« ã‚«ã‚¹ãƒ†ãƒƒãƒ­",
    cat: "wine",
    emoji: "ğŸ«™",
    img: null,
    lat: 35.6709, lng: 139.7649,
    address: "Ginza 7-chome, B1F",
    hours: "17:30 â€“ 01:00 (Sat from 16:00)  Â·  Closed Mon",
    price: "Â¥Â¥Â¥  Glasses from Â¥1,200",
    english: "English wine menu, Italian-Japanese staff",
    dresscode: "Casual smart",
    insider: "Italian-focused with a deep cellar of aged Barolo and Brunello. The food pairings â€” antipasti, charcuterie, small pasta plates â€” are excellent and fairly priced. Come here after a hostess club night or before heading into the bar scene. The basement energy is warm and convivial.",
    desc: "A serious Italian wine bar in Ginza's basement register. Deep Italian cellar, good small plates, warm atmosphere. A natural bridge between dinner and nightlife for those who want to keep the evening moving gently.",
    descJp: "éŠ€åº§ã®åœ°ä¸‹ã«æ§‹ãˆã‚‹ã‚¤ã‚¿ãƒªã‚¢ãƒ³ãƒ¯ã‚¤ãƒ³ãƒãƒ¼ã€‚ç†Ÿæˆãƒãƒ­ãƒ¼ãƒ­ã¨ãƒ–ãƒ«ãƒãƒƒãƒ­ã‚’æƒãˆãŸã‚»ãƒ©ãƒ¼ã¨è³ªã®é«˜ã„å°çš¿æ–™ç†ãŒã€å¤•é£Ÿã‹ã‚‰ãƒŠã‚¤ãƒˆãƒ©ã‚¤ãƒ•ã¸ã®æ©‹æ¸¡ã—ã‚’ã™ã‚‹ã€‚",
    insiderJp: "ã‚¤ã‚¿ãƒªã‚¢ç‰¹åŒ–ã§ç†Ÿæˆãƒãƒ­ãƒ¼ãƒ­ã¨ãƒ–ãƒ«ãƒãƒƒãƒ­ãŒå……å®Ÿã€‚ã‚¢ãƒ³ãƒ†ã‚£ãƒ‘ã‚¹ãƒˆãƒ»ã‚·ãƒ£ãƒ«ã‚­ãƒ¥ãƒˆãƒªãƒ»å°çš¿ãƒ‘ã‚¹ã‚¿ã¨ã®ãƒšã‚¢ãƒªãƒ³ã‚°ã‚‚çµ¶å“ã‹ã¤ãƒªãƒ¼ã‚ºãƒŠãƒ–ãƒ«ã€‚ãƒ›ã‚¹ãƒ†ã‚¹ã‚¯ãƒ©ãƒ–ã®å¾Œã‚„ãƒãƒ¼ã‚·ãƒ¼ãƒ³ã¸å‘ã‹ã†å‰ã®ä¸€è»’ã¨ã—ã¦æœ€é©ã€‚åœ°ä¸‹ã®ç©ºæ°—ã¯æ¸©ã‹ãä¼šè©±ãŒå¼¾ã‚€ã€‚",
    tags: ["Italian cellar", "Barolo & Brunello", "Food pairings", "Basement warmth"],
    insider_flag: false,
    gmaps: "https://maps.google.com/?q=Enoteca+Ginza+Tokyo"
  },

  /* â”€â”€â”€ CLUB â”€â”€â”€ */
  {
    id: 16,
    name: "Club Pasutone",
    nameJp: "ã‚¯ãƒ©ãƒ– ãƒ‘ã‚¹ãƒˆãƒ¼ãƒ³",
    cat: "club",
    emoji: "ğŸ¹",
    img: "https://www.ginzaclub-passtone.com/images/floor/main.jpg",
    lat: 35.6715, lng: 139.7651,
    address: "Ginza central, building disclosed at booking",
    hours: "19:30 â€“ 01:30",
    price: "Â¥Â¥Â¥Â¥  From Â¥30,000/person",
    english: "Limited â€” introduction recommended",
    dresscode: "Formal â€” dark suit",
    insider: "Ginza's only club with a resident grand piano played by a professional pianist â€” not background music, a live performance. The pianist reads the room's mood and adjusts accordingly. When the room is quiet, the music becomes extraordinary. Request a seat near the piano.",
    desc: "A distinguished Ginza club notable for its resident professional grand piano. The musical dimension elevates the atmosphere beyond a conventional hostess venue. Favored by those who appreciate that an evening should have artistic as well as social dimension.",
    descJp: "å°‚å±ãƒ—ãƒ­ãƒ”ã‚¢ãƒ‹ã‚¹ãƒˆãŒå¸¸é§ã‚°ãƒ©ãƒ³ãƒ‰ãƒ”ã‚¢ãƒã§æ¼”å¥ã™ã‚‹éŠ€åº§å”¯ä¸€ã®ã‚¯ãƒ©ãƒ–ã€‚èŠ¸è¡“çš„ãƒ»ç¤¾äº¤çš„ãªå¤œã®ä¸¡é¢ã‚’æ±‚ã‚ã‚‹ã‚²ã‚¹ãƒˆã«é¸ã°ã‚Œã‚‹æ ¼èª¿ã‚ã‚‹ç©ºé–“ã€‚",
    insiderJp: "éŠ€åº§å”¯ä¸€ã®ãƒ—ãƒ­ãƒ”ã‚¢ãƒ‹ã‚¹ãƒˆå¸¸é§ã‚¯ãƒ©ãƒ–â€”â€”BGMã§ã¯ãªãæœ¬ç‰©ã®ç”Ÿæ¼”å¥ã€‚ãƒ”ã‚¢ãƒ‹ã‚¹ãƒˆã¯å®¢å¸­ã®ç©ºæ°—ã‚’èª­ã‚“ã§æ¼”å¥ã‚’å¤‰ãˆã‚‹ã€‚éƒ¨å±‹ãŒé™ã‹ã«ãªã‚‹ã¨éŸ³æ¥½ãŒéš›ç«‹ã£ã¦æ ¼åˆ¥ã«ãªã‚‹ã€‚ãƒ”ã‚¢ãƒè¿‘ãã®å¸­ã‚’ãƒªã‚¯ã‚¨ã‚¹ãƒˆã—ã¦ã¿ã‚ˆã€‚",
    tags: ["Live grand piano", "Professional pianist", "Formal setting", "Unique in Ginza"],
    insider_flag: true,
    gmaps: "https://maps.google.com/?q=Club+Pasutone+Ginza+Tokyo"
  },
  {
    id: 17,
    name: "Venice Club",
    nameJp: "ãƒ´ã‚§ãƒ‹ã‚¹ã‚¯ãƒ©ãƒ–",
    cat: "club",
    emoji: "ğŸ°",
    img: "https://ginza-irodori.com/wp-content/uploads/2024/07/S__823607316_0-1024x768-1.webp",
    lat: 35.6706, lng: 139.7638,
    address: "Ginza 8-chome vicinity",
    hours: "19:00 â€“ 02:00",
    price: "Â¥Â¥Â¥Â¥  From Â¥25,000/person",
    english: "Some English-speaking staff on request",
    dresscode: "Smart â€” jacket preferred",
    insider: "The medieval Venetian interior design is genuinely impressive â€” arches, frescoes, the feel of a palazzo. It sounds theatrical but the execution is serious. Foreign guests often respond well to the visual impact. A good choice for international guests who want something that feels unmistakably Japanese in its hospitality but extraordinary in design.",
    desc: "A Ginza club built around a detailed medieval Venetian interior aesthetic. Frescoes, arched ceilings, a European atmosphere grafted onto Japanese omotenashi service. Unusual and memorable â€” the design conversation starter of Ginza nightlife.",
    descJp: "ä¸­ä¸–ãƒ´ã‚§ãƒãƒ„ã‚£ã‚¢é¢¨ã®æœ¬æ ¼çš„ã‚¤ãƒ³ãƒ†ãƒªã‚¢ã‚’æŒã¤éŠ€åº§ã®ã‚¯ãƒ©ãƒ–ã€‚ãƒ•ãƒ¬ã‚¹ã‚³ç”»ã¨ã‚¢ãƒ¼ãƒå¤©äº•ãŒæ—¥æœ¬å¼ãŠã‚‚ã¦ãªã—ã«ç•°å½©ã‚’æ”¾ã¤ã€‚ãƒ‡ã‚¶ã‚¤ãƒ³ãŒè©±é¡Œã«ãªã‚‹éŠ€åº§ãƒŠã‚¤ãƒˆãƒ©ã‚¤ãƒ•ã®ç•°è‰²ã®å­˜åœ¨ã€‚",
    insiderJp: "ä¸­ä¸–ãƒ´ã‚§ãƒãƒ„ã‚£ã‚¢ã®å†…è£…ã¯æœ¬æ°—ã§ä½œã‚Šè¾¼ã¾ã‚Œã¦ã„ã‚‹â€”â€”ã‚¢ãƒ¼ãƒã€ãƒ•ãƒ¬ã‚¹ã‚³ç”»ã€ãƒ‘ãƒ©ãƒƒãƒ„ã‚©ã®é›°å›²æ°—ã€‚èˆå°è£…ç½®çš„ã«èã“ãˆã‚‹ãŒå®Ÿç¾åº¦ã¯æœ¬ç‰©ã€‚ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ã®è¡æ’ƒã«å¤–å›½äººã‚²ã‚¹ãƒˆã¯ã‚ˆãåå¿œã™ã‚‹ã€‚æ—¥æœ¬å¼ãŠã‚‚ã¦ãªã—ã¨éæ—¥å¸¸ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ä¸¡ç«‹ã•ã›ãŸæ¥å¾…ã®å ´ã¨ã—ã¦é¸ã°ã‚Œã‚‹ã€‚",
    tags: ["Venetian interior", "Frescoes", "International-friendly", "Design standout"],
    insider_flag: false,
    gmaps: "https://maps.google.com/?q=Venice+Club+Ginza+Tokyo"
  },

];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let currentCat   = 'all';
let currentQuery = '';
let activeId     = null;
let map, markers = {};
let lang       = 'en';
let userMarker   = null;
let routeWatchId = null;   // watchPosition ID for real-time position tracking during routing
let activeSpot   = null;

/* â”€â”€ Mobile bottom sheet state â”€â”€ */
let panelState = 'bar'; // 'bar' | 'half' | 'full'
function isMobile() { return window.innerWidth <= 720; }
function setPanelState(state) {
  const panel = document.getElementById('panel');
  panel.classList.remove('sheet-half', 'sheet-full');
  if (state === 'half') panel.classList.add('sheet-half');
  if (state === 'full') panel.classList.add('sheet-full');
  panelState = state;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   INIT MAP â€” MapLibre GL JS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function initMap() {
  map = new maplibregl.Map({
    container: 'map',
    // Carto Voyager-GL: ç¢ºå®Ÿã«å‹•ããƒ™ã‚¯ã‚¿ãƒ¼ã‚¿ã‚¤ãƒ«ã€no API key å¿…è¦ãªã—
    style: 'https://basemaps.cartocdn.com/gl/voyager-gl-style/style.json',
    center: [139.765, 35.6714],   // MapLibre ã¯ [lng, lat] ã®é †
    zoom: 15.5,
    attributionControl: false,
  });

  // Attribution (ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆè¡¨ç¤º)
  map.addControl(new maplibregl.AttributionControl({ compact: true }), 'bottom-right');

  // ã‚ºãƒ¼ãƒ ãƒœã‚¿ãƒ³ (bottomleft â€” ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³ã¨é‡è¤‡ã—ãªã„)
  map.addControl(new maplibregl.NavigationControl({ showCompass: false }), 'bottom-left');

  // ãƒãƒƒãƒ—èƒŒæ™¯ã‚¯ãƒªãƒƒã‚¯ã§è©³ç´°ã‚’é–‰ã˜ã‚‹ï¼ˆãƒ¢ãƒã‚¤ãƒ«ã¯ãƒ‘ãƒãƒ«ã‚‚ãƒãƒ¼ã«æˆ»ã™ï¼‰
  map.on('click', () => {
    closeDetail();
    if (isMobile()) setPanelState('bar');
  });

  // ã‚¹ã‚¿ã‚¤ãƒ«ãƒ­ãƒ¼ãƒ‰å®Œäº†å¾Œ: ãƒãƒ¼ã‚«ãƒ¼é…ç½®
  map.on('load', () => {

    SPOTS.forEach((s, i) => {
      const cfg = CAT[s.cat];
      const imgHtml = s.img
        ? `<img src="${s.img}" alt="${s.name}" loading="lazy"
             onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">`
        : '';
      const fallbackStyle = s.img ? 'style="display:none"' : '';

      // wrapper: MapLibre ãŒ transform ã§ä½ç½®æ±ºã‚ã™ã‚‹è¦ç´ ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãªã—ï¼‰
      const wrapper = document.createElement('div');
      wrapper.style.cssText = 'width:46px;height:54px;cursor:pointer;';
      wrapper.addEventListener('click', e => { e.stopPropagation(); openDetail(s.id); });

      // mk-pin: wrapper ã®å­è¦ç´ ï¼ˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãŒ wrapper ã® transform ã«å¹²æ¸‰ã—ãªã„ï¼‰
      const el = document.createElement('div');
      el.className = 'mk-pin';
      el.id = `mkpin-${s.id}`;
      el.style.animationDelay = `${i * 80}ms`;
      el.innerHTML = `
        <div class="mk-circle" style="border-color:${cfg.color}">
          ${imgHtml}
          <div class="mk-fallback" ${fallbackStyle} style="background:${cfg.bg}">${s.emoji}</div>
        </div>
        <span class="mk-tail" style="border-top-color:${cfg.color}"></span>`;
      wrapper.appendChild(el);

      const m = new maplibregl.Marker({ element: wrapper, anchor: 'bottom' })
        .setLngLat([s.lng, s.lat])
        .addTo(map);
      markers[s.id] = m;
    });
  });

  renderList();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APPLY PURPLE THEME â€” Carto ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ä¸Šæ›¸ã
   source-layer å + ãƒ¬ã‚¤ãƒ¤ãƒ¼ID ã§è¦ç´ åˆ¥ã«ç´«ã‚«ãƒ©ãƒ¼é©ç”¨
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function applyPurpleTheme() {
  const P = {
    bg:          '#0d0a16',
    water:       '#06040e',
    waterway:    '#08060f',
    building:    '#1c1330',
    buildingOut: '#34215e',
    land:        '#100e26',
    park:        '#0f0e24',
    pathRoad:    '#1a1040',
    serviceRd:   '#1e1448',
    minorRd:     '#2a1a60',
    secondaryRd: '#3d2880',
    primaryRd:   '#5535a8',
    trunk:       '#7040c0',
    rdCase:      '#08060f',
    railway:     '#4a34b0',
    labelPlace:  '#c0a0e8',
    labelRoad:   '#6855a8',
    labelHalo:   '#0d0a16',
  };

  try {
    map.getStyle().layers.forEach(layer => {
      const sl  = layer['source-layer'] || '';
      const id  = layer.id;
      const typ = layer.type;
      try {
        /* â”€â”€â”€ Background â”€â”€â”€ */
        if (typ === 'background') {
          map.setPaintProperty(id, 'background-color', P.bg); return;
        }
        /* â”€â”€â”€ Water â”€â”€â”€ */
        if (sl === 'water' && typ === 'fill') {
          map.setPaintProperty(id, 'fill-color', P.water);
          map.setPaintProperty(id, 'fill-opacity', 1); return;
        }
        if ((sl === 'waterway' || sl === 'water') && typ === 'line') {
          map.setPaintProperty(id, 'line-color', P.waterway); return;
        }
        /* â”€â”€â”€ Buildings â”€â”€â”€ */
        if (sl === 'building' && typ === 'fill') {
          map.setPaintProperty(id, 'fill-color', P.building);
          try { map.setPaintProperty(id, 'fill-outline-color', P.buildingOut); } catch(e) {}
          return;
        }
        /* â”€â”€â”€ Land / park â”€â”€â”€ */
        if (typ === 'fill' && (sl === 'landcover' || sl === 'landuse' || sl === 'park'
            || /land|park|green|wood|grass|crop|cemetery|hospital|school/i.test(id))) {
          const c = /park|green|wood|grass|scrub|forest/i.test(id) ? P.park : P.land;
          map.setPaintProperty(id, 'fill-color', c);
          map.setPaintProperty(id, 'fill-opacity', 1); return;
        }
        /* â”€â”€â”€ Roads â”€â”€â”€ */
        if (sl === 'transportation' && typ === 'line') {
          let c = P.minorRd;
          if (/motorway|trunk|highway/i.test(id))        c = P.trunk;
          else if (/primary/i.test(id))                  c = P.primaryRd;
          else if (/secondary|tertiary/i.test(id))       c = P.secondaryRd;
          else if (/service|track/i.test(id))            c = P.serviceRd;
          else if (/path|pedestrian|footway/i.test(id))  c = P.pathRoad;
          else if (/case|outline|casing/i.test(id))      c = P.rdCase;
          map.setPaintProperty(id, 'line-color', c); return;
        }
        /* â”€â”€â”€ Line â”€â”€â”€ (ãã®ä»–ã®çº¿ãƒ¬ã‚¤ãƒ¤ãƒ¼) */
        if (typ === 'line') {
          if (/rail|transit|subway|train/i.test(id) || sl === 'rail') {
            map.setPaintProperty(id, 'line-color', P.railway); return;
          }
          map.setPaintProperty(id, 'line-color', P.land); return;
        }
        /* â”€â”€â”€ Fill â”€â”€â”€ (ãã®ä»–ã®fillãƒ¬ã‚¤ãƒ¤ãƒ¼) */
        if (typ === 'fill') {
          map.setPaintProperty(id, 'fill-color', P.land);
          map.setPaintProperty(id, 'fill-opacity', 1); return;
        }
        /* â”€â”€â”€ Labels â”€â”€â”€ */
        if (typ === 'symbol') {
          if (sl === 'poi') { map.setLayoutProperty(id, 'visibility', 'none'); return; }
          const textC = (sl === 'place' || /place|city|town|village|suburb/i.test(id))
            ? P.labelPlace : P.labelRoad;
          try { map.setPaintProperty(id, 'text-color', textC); } catch(e) {}
          try { map.setPaintProperty(id, 'text-halo-color', P.labelHalo); } catch(e) {}
          try { map.setPaintProperty(id, 'text-halo-width', 1.2); } catch(e) {}
        }
      } catch(e) {} // ãƒ¬ã‚¤ãƒ¤ãƒ¼ã”ã¨ã®ã‚¨ãƒ©ãƒ¼ã¯ç„¡è¦–
    });
  } catch(e) { console.warn('applyPurpleTheme error:', e); }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FILTER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function filtered() {
  return SPOTS.filter(s => {
    const matchCat = currentCat === 'all'
      || (currentCat === 'open' ? isOpenNow(s) === true : s.cat === currentCat);
    const q = currentQuery.toLowerCase().trim();
    const matchQ = !q ||
      s.name.toLowerCase().includes(q) ||
      s.nameJp.includes(q) ||
      s.desc.toLowerCase().includes(q) ||
      s.tags.some(t => t.toLowerCase().includes(q)) ||
      CAT[s.cat].label.toLowerCase().includes(q);
    return matchCat && matchQ;
  });
}

function setCat(cat, el) {
  currentCat = cat;
  document.querySelectorAll('.pill').forEach(p => p.classList.remove('active'));
  el.classList.add('active');
  syncMarkers();
  renderList();
}

function onSearch() {
  currentQuery = document.getElementById('search').value;
  syncMarkers();
  renderList();
}

function syncMarkers() {
  const visible = new Set(filtered().map(s => s.id));
  SPOTS.forEach(s => {
    const m = markers[s.id];
    if (!m) return;
    if (visible.has(s.id)) {
      if (!m._map) m.addTo(map);
    } else {
      if (m._map) m.remove();
    }
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RENDER LIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderList() {
  const spots = filtered();
  document.getElementById('count-num').textContent = UI[lang].spotsCount(spots.length);

  const list = document.getElementById('spot-list');
  if (!spots.length) {
    list.innerHTML = `<div class="empty-state"><div style="font-size:32px">ğŸ”</div><p>${UI[lang].emptyText}</p></div>`;
    return;
  }

  // Group by category for readability when showing all
  if (currentCat === 'all' && !currentQuery) {
    const groups = {};
    spots.forEach(s => {
      if (!groups[s.cat]) groups[s.cat] = [];
      groups[s.cat].push(s);
    });
    list.innerHTML = Object.entries(groups).map(([cat, ss]) =>
      `<div class="group-label">${CAT[cat].label}</div>` + ss.map(s => cardHTML(s)).join('')
    ).join('');
  } else {
    list.innerHTML = spots.map(s => cardHTML(s)).join('');
  }
}

function cardHTML(s) {
  const cfg = CAT[s.cat];
  const displayName = lang === 'jp' ? s.nameJp : s.name;
  const displaySub  = lang === 'jp' ? s.name   : s.nameJp;
  const openBadge   = isOpenNow(s) === true ? `<span class="open-badge">${UI[lang].openBadge}</span>` : '';
  const imgContent = s.img
    ? `<img src="${s.img}" alt="${s.name}" loading="lazy" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'">
       <div class="icon-fallback" style="display:none;background:${cfg.bg}">${s.emoji}</div>`
    : `<div class="icon-fallback" style="background:${cfg.bg}">${s.emoji}</div>`;
  return `
    <div class="spot-card${s.id === activeId ? ' active' : ''}" id="card-${s.id}" onclick="openDetail(${s.id})">
      <div class="card-icon">${imgContent}</div>
      <div class="card-body">
        <div class="card-name">${displayName}</div>
        <div class="card-sub">${displaySub}</div>
        <div class="card-meta">
          <span class="card-price">${s.price.split('  ')[0]}</span>
          ${s.insider_flag ? '<span class="insider-tag">Insider</span>' : ''}
          ${openBadge}
        </div>
      </div>
      <span class="card-chevron">â€º</span>
    </div>`;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DETAIL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function openDetail(id) {
  const s = SPOTS.find(x => x.id === id);
  if (!s) return;
  activeId   = id;
  activeSpot = s;

  const cfg = CAT[s.cat];

  // Hero image / fallback
  const heroWrap = document.getElementById('d-hero-img-wrap');
  if (s.img) {
    heroWrap.innerHTML = `
      <img class="sheet-hero-img" src="${s.img}" alt="${s.name}"
        onerror="this.outerHTML='<div class=\\'sheet-hero-fallback\\' style=\\'background:${cfg.bg}\\'>${s.emoji}</div>'">`;
  } else {
    heroWrap.innerHTML = `<div class="sheet-hero-fallback" style="background:${cfg.bg}">${s.emoji}</div>`;
  }

  document.getElementById('d-name').textContent    = s.name;
  document.getElementById('d-namejp').textContent  = s.nameJp;

  const pill = document.getElementById('d-catpill');
  pill.style.background = cfg.color;

  document.getElementById('d-insider').textContent =
    lang === 'jp' && s.insiderJp ? s.insiderJp : s.insider;

  const u = UI[lang];
  const catKey = { bar:'catBar', club:'catClub', hostess:'catHostess', lounge:'catLounge', jazz:'catJazz', wine:'catWine' };
  pill.textContent = u[catKey[s.cat]] || cfg.label;

  document.getElementById('d-meta').innerHTML = `
    <div class="meta-card">
      <div class="meta-card-label">${u.metaHours}</div>
      <div class="meta-card-val">${s.hours}</div>
    </div>
    <div class="meta-card">
      <div class="meta-card-label">${u.metaPrice}</div>
      <div class="meta-card-val">${s.price}</div>
    </div>
    <div class="meta-card">
      <div class="meta-card-label">${u.metaEnglish}</div>
      <div class="meta-card-val">${s.english}</div>
    </div>
    <div class="meta-card">
      <div class="meta-card-label">${u.metaDress}</div>
      <div class="meta-card-val">${s.dresscode}</div>
    </div>
  `;

  document.getElementById('d-desc').textContent =
    lang === 'jp' && s.descJp ? s.descJp : s.desc;
  document.getElementById('d-tags').innerHTML = s.tags.map(t => `<span class="sheet-tag">${t}</span>`).join('');
  document.getElementById('d-gmaps').href = s.gmaps;

  // ãƒ¢ãƒã‚¤ãƒ«: è©³ç´°ã‚’é–‹ã„ãŸã‚‰ãƒ‘ãƒãƒ«ã‚’ãƒãƒ¼ã«ç¸®å°ã—ã¦ãƒãƒƒãƒ—ã‚’è¦‹ã›ã‚‹
  if (isMobile()) setPanelState('bar');

  document.getElementById('detail').classList.add('open');
  // MapLibre flyTo â€” ãƒ¢ãƒã‚¤ãƒ«æ™‚ã¯ offset ã§è©³ç´°ã‚·ãƒ¼ãƒˆã«éš ã‚Œãªã„ã‚ˆã†ä¸Šã«ã‚ªãƒ•ã‚»ãƒƒãƒˆ
  // offset: [0, -150] â†’ ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆä¸­å¿ƒã‚ˆã‚Š 150px ä¸Šã«é…ç½®ã•ã‚Œã‚‹
  if (isMobile()) {
    map.flyTo({ center: [s.lng, s.lat], zoom: 16, speed: 0.7, offset: [0, -150] });
  } else {
    map.flyTo({ center: [s.lng, s.lat], zoom: 16, speed: 0.7 });
  }

  // Highlight card
  document.querySelectorAll('.spot-card').forEach(c => c.classList.remove('active'));
  const card = document.getElementById(`card-${id}`);
  if (card) { card.classList.add('active'); card.scrollIntoView({ behavior: 'smooth', block: 'nearest' }); }

  // Highlight marker pin (gold ring)
  document.querySelectorAll('.mk-pin').forEach(p => p.classList.remove('active'));
  const pin = document.getElementById(`mkpin-${id}`);
  if (pin) pin.classList.add('active');
}

function closeDetail() {
  clearRoute();   // ãƒ«ãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã¨ watchPosition ã‚’ã‚¯ãƒªã‚¢
  const el = document.getElementById('detail');
  el.style.transform = '';  // ã‚¹ãƒ¯ã‚¤ãƒ—ä¸­æ–­æ™‚ã®ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³transformã‚’ã‚¯ãƒªã‚¢
  el.classList.remove('open');
  activeId   = null;
  activeSpot = null;
  document.querySelectorAll('.spot-card').forEach(c => c.classList.remove('active'));
  document.querySelectorAll('.mk-pin').forEach(p => p.classList.remove('active'));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PANEL MINIMIZE / RESTORE
   Single #panel element morphs between full sidebar
   and a 44Ã—44 button via CSS width/bottom transitions.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function minimizeSidebar(e) {
  if (e) e.stopPropagation();
  if (isMobile()) { setPanelState('bar'); return; }
  // PC: æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯
  const panel  = document.getElementById('panel');
  const detail = document.getElementById('detail');
  panel.classList.add('minimized');
  setTimeout(() => { detail.style.left = '20px'; }, 200);
}

function restoreSidebar() {
  if (isMobile()) { setPanelState('half'); return; }
  // PC: æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯
  const panel  = document.getElementById('panel');
  const detail = document.getElementById('detail');
  panel.classList.remove('minimized');
  setTimeout(() => { detail.style.left = '380px'; }, 200);
}

function handlePanelClick(e) {
  if (!isMobile()) {
    // PC: minimized ãªã‚‰å¾©å…ƒ
    const panel = document.getElementById('panel');
    if (panel.classList.contains('minimized')) restoreSidebar();
    return;
  }
  // ãƒ¢ãƒã‚¤ãƒ«: topbar / ãƒãƒ³ãƒ‰ãƒ« / ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã®ã‚¿ãƒƒãƒ—ã§æ®µéšå±•é–‹
  const topbar  = document.getElementById('sidebar-topbar');
  const handle  = document.getElementById('panel-drag-handle');
  const filters = document.getElementById('filters');
  const target  = e.target;
  if (!topbar.contains(target) && target !== handle && !filters.contains(target)) return;
  if (panelState === 'bar')       setPanelState('half');
  else if (panelState === 'half') setPanelState('full');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE BOTTOM SHEET â€” SWIPE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function initBottomSheetSwipe() {
  if (!isMobile()) return;
  const panel  = document.getElementById('panel');
  const handle = document.getElementById('panel-drag-handle');
  const topbar = document.getElementById('sidebar-topbar');
  let startY = 0, startH = 0;

  function onStart(e) {
    startY = e.touches[0].clientY;
    startH = panel.offsetHeight;
    panel.style.transition = 'none';
  }
  function onMove(e) {
    const dy  = startY - e.touches[0].clientY;
    const max = window.innerHeight * 0.92;
    panel.style.height = Math.max(88, Math.min(max, startH + dy)) + 'px';
  }
  function onEnd(e) {
    panel.style.transition = '';
    panel.style.height = '';
    const dy = startY - e.changedTouches[0].clientY;
    if (dy > 60) {
      setPanelState(panelState === 'bar' ? 'half' : 'full'); // ä¸Šã‚¹ãƒ¯ã‚¤ãƒ—: æ®µéšçš„ã«å±•é–‹
    } else if (dy < -60) {
      setPanelState('bar');   // ä¸‹ã‚¹ãƒ¯ã‚¤ãƒ—: å³ãƒãƒ¼çŠ¶æ…‹ã¸ï¼ˆhalf çµŒç”±ãªã—ï¼‰
      closeDetail();          // è©³ç´°ã‚·ãƒ¼ãƒˆã‚‚é–‰ã˜ã‚‹
    } else {
      setPanelState(panelState); // å¾®å°ç§»å‹•: ã‚¹ãƒŠãƒƒãƒ—ï¼ˆå…ƒã®çŠ¶æ…‹ã‚’ç¶­æŒï¼‰
    }
  }

  [handle, topbar].forEach(el => {
    el.addEventListener('touchstart', onStart, { passive: true });
    el.addEventListener('touchmove',  onMove,  { passive: true });
    el.addEventListener('touchend',   onEnd);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   OPEN NOW â€” hours parser
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function isOpenNow(s) {
  const now = new Date();
  const dow = now.getDay(); // 0=Sun,1=Mon...
  const hrs = now.getHours() * 60 + now.getMinutes();
  const h   = s.hours || '';
  // Closed day check
  const closedMap = { Sun:0, Mon:1, Tue:2, Wed:3, Thu:4, Fri:5, Sat:6 };
  for (const [d, n] of Object.entries(closedMap)) {
    if (h.includes(`Closed ${d}`) && dow === n) return false;
  }
  // Parse first HH:MM â€“ HH:MM
  const m = h.match(/(\d{1,2}):(\d{2})\s*[â€“\-]\s*(\d{1,2}):(\d{2})/);
  if (!m) return null;
  const open  = +m[1] * 60 + +m[2];
  const close = +m[3] * 60 + +m[4];
  if (close <= open) { // midnight crossing e.g. 19:00 â€“ 02:00
    return hrs >= open || hrs < close;
  }
  return hrs >= open && hrs < close;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   UI STRINGS â€” è¨€èªåˆ¥å›ºå®šãƒ†ã‚­ã‚¹ãƒˆ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const UI = {
  en: {
    tagline: 'Insider Guide',
    desc: "Curated by a local who has walked these streets for over 20 years. The bars, clubs, and lounges that Ginza's regulars actually go to.",
    searchPlaceholder: 'Search venues, vibesâ€¦',
    nightLabel: 'Ginza Nightlife Map',
    catAll: 'All', catBar: 'Authentic Bar', catClub: 'Club',
    catHostess: 'Hostess Club', catLounge: 'Lounge',
    catJazz: 'Jazz Bar', catWine: 'Wine Bar', catOpen: 'Open Now',
    allVenues: 'All venues',
    spotsCount: n => `${n} spot${n !== 1 ? 's' : ''}`,
    insiderTip: 'Insider Tip',
    metaHours: 'Hours', metaPrice: 'Price Range',
    metaEnglish: 'English', metaDress: 'Dress Code',
    ctaLabel: 'Open in Google Maps', ctaSub: 'Tap for directions',
    emptyText: 'No venues match your search.<br>Try a different keyword or category.',
    locDenied: 'Location access denied',
    locUnsupported: 'Geolocation not supported',
    copied: 'Copied to clipboard', copyFailed: 'Copy failed',
    openBadge: 'â— Open',
    routeBtn: 'Show walking route from here',
    routeError: 'Could not fetch walking route',
  },
  jp: {
    tagline: 'ã‚¤ãƒ³ã‚µã‚¤ãƒ€ãƒ¼ã‚¬ã‚¤ãƒ‰',
    desc: 'éŠ€åº§ã®å¤œã‚’20å¹´ä»¥ä¸Šæ­©ã„ã¦ããŸãƒ­ãƒ¼ã‚«ãƒ«ãŒå³é¸ã€‚åœ°å…ƒã®å¸¸é€£ãŒå®Ÿéš›ã«é€šã†ãƒãƒ¼ãƒ»ã‚¯ãƒ©ãƒ–ãƒ»ãƒ©ã‚¦ãƒ³ã‚¸ã€‚',
    searchPlaceholder: 'ã‚¹ãƒãƒƒãƒˆã€é›°å›²æ°—ã§æ¤œç´¢â€¦',
    nightLabel: 'éŠ€åº§ãƒŠã‚¤ãƒˆãƒ©ã‚¤ãƒ•ãƒãƒƒãƒ—',
    catAll: 'ã™ã¹ã¦', catBar: 'ãƒãƒ¼', catClub: 'ã‚¯ãƒ©ãƒ–',
    catHostess: 'ãƒ›ã‚¹ãƒ†ã‚¹ã‚¯ãƒ©ãƒ–', catLounge: 'ãƒ©ã‚¦ãƒ³ã‚¸',
    catJazz: 'ã‚¸ãƒ£ã‚ºãƒãƒ¼', catWine: 'ãƒ¯ã‚¤ãƒ³ãƒãƒ¼', catOpen: 'å–¶æ¥­ä¸­',
    allVenues: 'å…¨ã‚¹ãƒãƒƒãƒˆ',
    spotsCount: n => `${n} ä»¶`,
    insiderTip: 'ã‚¤ãƒ³ã‚µã‚¤ãƒ€ãƒ¼ Tip',
    metaHours: 'å–¶æ¥­æ™‚é–“', metaPrice: 'æ–™é‡‘ç›®å®‰',
    metaEnglish: 'è‹±èªå¯¾å¿œ', metaDress: 'ãƒ‰ãƒ¬ã‚¹ã‚³ãƒ¼ãƒ‰',
    ctaLabel: 'Google ãƒãƒƒãƒ—ã§é–‹ã', ctaSub: 'ã‚¿ãƒƒãƒ—ã§é“æ¡ˆå†…',
    emptyText: 'æ¡ä»¶ã«åˆã†ã‚¹ãƒãƒƒãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚<br>ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’å¤‰ãˆã¦ã¿ã¦ãã ã•ã„ã€‚',
    locDenied: 'ä½ç½®æƒ…å ±ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ãŒæ‹’å¦ã•ã‚Œã¾ã—ãŸ',
    locUnsupported: 'ä½ç½®æƒ…å ±ã‚’åˆ©ç”¨ã§ãã¾ã›ã‚“',
    copied: 'ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ', copyFailed: 'ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ',
    openBadge: 'â— å–¶æ¥­ä¸­',
    routeBtn: 'ç¾åœ¨åœ°ã‹ã‚‰ã®ãƒ«ãƒ¼ãƒˆã‚’è¡¨ç¤º',
    routeError: 'ãƒ«ãƒ¼ãƒˆã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ',
  }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APPLY LANG â€” å›ºå®šUIãƒ†ã‚­ã‚¹ãƒˆã‚’ç¾åœ¨è¨€èªã§æ›´æ–°
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function applyLang() {
  const u = UI[lang];
  const set = (id, val) => { const el = document.getElementById(id); if (el) el.textContent = val; };
  set('ui-tagline',     u.tagline);
  set('ui-desc',        u.desc);
  set('ui-nightlabel',  u.nightLabel);
  set('ui-all-venues',  u.allVenues);
  set('ui-insider-tip', u.insiderTip);
  set('ui-gmaps-label', u.ctaLabel);
  set('ui-gmaps-sub',   u.ctaSub);
  set('ui-route-label', u.routeBtn);
  set('lang-btn',       lang === 'en' ? 'EN' : 'JP');
  // æ¤œç´¢ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
  const searchEl = document.getElementById('search');
  if (searchEl) searchEl.placeholder = u.searchPlaceholder;
  // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ”ãƒ«
  const pillMap = { all:'catAll', bar:'catBar', club:'catClub', hostess:'catHostess', lounge:'catLounge', jazz:'catJazz', wine:'catWine', open:'catOpen' };
  document.querySelectorAll('.pill[data-cat]').forEach(p => {
    const key = pillMap[p.dataset.cat];
    if (!key) return;
    const dot = p.querySelector('.pill-dot');
    p.textContent = u[key];
    if (dot) p.prepend(dot);
  });
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   LANGUAGE TOGGLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function toggleLang() {
  lang = lang === 'en' ? 'jp' : 'en';
  applyLang();
  if (activeId) openDetail(activeId);
  renderList();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   GEOLOCATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function locateMe() {
  if (!navigator.geolocation) { showToast(UI[lang].locUnsupported); return; }
  navigator.geolocation.getCurrentPosition(pos => {
    const { latitude: lat, longitude: lng } = pos.coords;
    if (!userMarker) {
      const el = document.createElement('div');
      el.className = 'user-location-marker';
      userMarker = new maplibregl.Marker({ element: el })
        .setLngLat([lng, lat])
        .addTo(map);
    } else {
      userMarker.setLngLat([lng, lat]);
    }
    map.flyTo({ center: [lng, lat], zoom: 16, speed: 0.8 });
  }, () => showToast(UI[lang].locDenied));
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   ROUTE â€” OSRM å¾’æ­©ãƒ«ãƒ¼ãƒˆè¡¨ç¤º
   Free public API, no key required
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const OSRM_BASE = 'https://routing.openstreetmap.de/routed-foot/route/v1/driving';

function _setRouteBtn(html) {
  const btn = document.getElementById('route-btn');
  if (btn) btn.innerHTML = html;
}
function _routeBtnDefault() {
  _setRouteBtn(`<span>ğŸš¶</span><span id="ui-route-label">${UI[lang].routeBtn}</span>`);
}

function showRoute() {
  if (!activeSpot) return;
  if (!navigator.geolocation) { showToast(UI[lang].locUnsupported); return; }
  const s = activeSpot;
  _setRouteBtn('<span>ğŸ“</span><span>ç¾åœ¨åœ°ã‚’å–å¾—ä¸­â€¦</span>');

  // æ—¢å­˜ã® watchPosition ã‚’è§£é™¤
  if (routeWatchId !== null) {
    navigator.geolocation.clearWatch(routeWatchId);
    routeWatchId = null;
  }

  navigator.geolocation.getCurrentPosition(async pos => {
    const { latitude: lat, longitude: lng } = pos.coords;

    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒãƒ¼ã‚«ãƒ¼ã‚’é…ç½® / æ›´æ–°
    if (!userMarker) {
      const el = document.createElement('div');
      el.className = 'user-location-marker';
      userMarker = new maplibregl.Marker({ element: el }).setLngLat([lng, lat]).addTo(map);
    } else {
      userMarker.setLngLat([lng, lat]);
    }

    // OSRM å¾’æ­©ãƒ«ãƒ¼ãƒˆå–å¾—ï¼ˆã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ 6 ç§’ï¼‰
    const ctrl = new AbortController();
    const timer = setTimeout(() => ctrl.abort(), 6000);
    try {
      const url = `${OSRM_BASE}/${lng},${lat};${s.lng},${s.lat}?overview=full&geometries=geojson`;
      const res = await fetch(url, { signal: ctrl.signal });
      clearTimeout(timer);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();
      if (data.code !== 'Ok' || !data.routes?.[0]) throw new Error('no route: ' + data.code);
      const route = data.routes[0];

      // MapLibre ã«ãƒ«ãƒ¼ãƒˆãƒ©ã‚¤ãƒ³ã‚’æç”»
      // â€» line-dasharray ã¨ line-cap:round ã¯éäº’æ›ã®ãŸã‚ solid line ã‚’ä½¿ç”¨
      const geojsonFeature = { type: 'Feature', properties: {}, geometry: route.geometry };
      if (map.getLayer('route-line')) {
        map.getSource('route-src').setData(geojsonFeature);
      } else {
        map.addSource('route-src', { type: 'geojson', data: geojsonFeature });
        map.addLayer({
          id: 'route-line', type: 'line', source: 'route-src',
          layout: { 'line-join': 'round', 'line-cap': 'round' },
          paint: { 'line-color': '#7040c0', 'line-width': 5, 'line-opacity': 1 }
        });
      }

      // è·é›¢ãƒ»æ™‚é–“ãƒãƒƒã‚¸ã‚’è¡¨ç¤º
      const dist = Math.round(route.distance);
      const mins = Math.max(1, Math.round(route.duration / 60));
      const distStr = dist < 1000 ? `${dist}m` : `${(dist / 1000).toFixed(1)}km`;
      document.getElementById('route-dist').textContent = distStr;
      document.getElementById('route-time').textContent = `å¾’æ­©ç´„${mins}åˆ†`;
      const infoEl = document.getElementById('route-info');
      if (infoEl) infoEl.style.display = 'flex';

      // ç¾åœ¨åœ°ã€œç›®çš„åœ°ãŒä¸¡æ–¹è¦‹ãˆã‚‹ã‚ˆã†ã«åœ°å›³ã‚’ãƒ•ã‚£ãƒƒãƒˆ
      const bounds = new maplibregl.LngLatBounds()
        .extend([lng, lat]).extend([s.lng, s.lat]);
      map.fitBounds(bounds, { padding: 80, minZoom: 13, maxZoom: 17, duration: 800 });

      // watchPosition ã§ä½ç½®ãƒ‰ãƒƒãƒˆã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
      routeWatchId = navigator.geolocation.watchPosition(wp => {
        if (userMarker) userMarker.setLngLat([wp.coords.longitude, wp.coords.latitude]);
      }, null, { enableHighAccuracy: true });

    } catch (e) {
      clearTimeout(timer);
      console.error('Route fetch error:', e);
      // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: Google Maps å¾’æ­©ãƒ«ãƒ¼ãƒˆãƒªãƒ³ã‚¯ã‚’ã‚»ãƒƒãƒˆ
      const gmaps = document.getElementById('d-gmaps');
      if (gmaps) {
        gmaps.href = `https://www.google.com/maps/dir/?api=1&origin=${lat},${lng}&destination=${s.lat},${s.lng}&travelmode=walking`;
      }
      showToast(UI[lang].routeError);
    }

    _routeBtnDefault();
  }, () => {
    showToast(UI[lang].locDenied);
    _routeBtnDefault();
  });
}

function clearRoute() {
  if (routeWatchId !== null) {
    navigator.geolocation.clearWatch(routeWatchId);
    routeWatchId = null;
  }
  if (map.getLayer('route-line')) map.removeLayer('route-line');
  if (map.getSource('route-src')) map.removeSource('route-src');
  const infoEl = document.getElementById('route-info');
  if (infoEl) infoEl.style.display = 'none';
  _routeBtnDefault();
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SHARE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function shareVenue() {
  if (!activeSpot) return;
  const text = `${activeSpot.name} â€” ${activeSpot.nameJp}`;
  if (navigator.share) {
    navigator.share({ title: activeSpot.name, text, url: activeSpot.gmaps });
  } else {
    navigator.clipboard?.writeText(`${text}\n${activeSpot.gmaps}`)
      .then(() => showToast(UI[lang].copied))
      .catch(() => showToast(UI[lang].copyFailed));
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2500);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   DETAIL SHEET SWIPE-TO-CLOSE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function initTouchSwipe() {
  const el     = document.getElementById('detail');
  const scroll = el.querySelector('.sheet-scroll');
  let startY = 0, dragging = false;
  el.addEventListener('touchstart', e => {
    if (scroll.scrollTop > 0) return;
    startY = e.touches[0].clientY;
    dragging = true;
    el.style.transition = 'none';
  }, { passive: true });
  el.addEventListener('touchmove', e => {
    if (!dragging) return;
    const dy = e.touches[0].clientY - startY;
    if (dy > 0) el.style.transform = `translateY(${dy}px)`;
  }, { passive: true });
  el.addEventListener('touchend', e => {
    if (!dragging) return;
    dragging = false;
    el.style.transition = '';
    if (e.changedTouches[0].clientY - startY > 80) {
      closeDetail();
    } else {
      el.style.transform = '';
    }
  });
}

window.addEventListener('DOMContentLoaded', () => {
  initMap();
  applyLang();   // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ(en)ã®å›ºå®šUIãƒ†ã‚­ã‚¹ãƒˆã‚’é©ç”¨
  initBottomSheetSwipe();
  initTouchSwipe();
});
</script>
<div id="toast"></div>
</body>
</html>
